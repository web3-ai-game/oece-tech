# ğŸ‰ æ™ºèƒ½è·¯ç”±ç³»ç»Ÿéƒ¨ç½²å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ğŸ“‹ DoppleræœåŠ¡åˆ†ç±»æ¸…å•
**æ–‡ä»¶**: `DOPPLER_SERVICES_CLASSIFICATION.md`

**å†…å®¹**:
- âœ… å…¨éƒ¨53ä¸ªé…ç½®å˜é‡åˆ†ç±»
- âœ… AIæœåŠ¡é…ç½®ï¼ˆGemini, OpenAI, Anthropicï¼‰
- âœ… 3ä¸ªTelegram Boté…ç½®
- âœ… æ•°æ®åº“æœåŠ¡ï¼ˆSupabase, PostgreSQL, Redisï¼‰
- âœ… å®‰å…¨è®¤è¯é…ç½®
- âœ… ç«¯å£å’Œç½‘ç»œé…ç½®

**å…³é”®å‘ç°**:
- ğŸ”´ Geminiåªæœ‰1ä¸ªKeyï¼Œéœ€è¦æ·»åŠ 25ä¸ª
- ğŸ”´ Rediså·²é…ç½®ä½†æœªå®‰è£…
- âš ï¸ svskilo_bot Tokenä¸åœ¨Dopplerä¸­
- âš ï¸ OpenAI/Anthropicä½¿ç”¨å ä½ç¬¦

**å»ºè®®ä¼˜å…ˆçº§**:
1. ç«‹å³å°†25ä¸ªGemini Keysæ·»åŠ åˆ°Doppler
2. å®‰è£…å¹¶é…ç½®Redis
3. æ·»åŠ svskilo_bot Token
4. æ¸…ç†æ— ç”¨é…ç½®

---

### 2. ğŸ”‘ æ™ºèƒ½Keyè·¯ç”±ç³»ç»Ÿ
**æ–‡ä»¶**: `gemini_key_router_v2.py`

**æ ¸å¿ƒåŠŸèƒ½**:
```python
class GeminiKeyRouter:
    - RPM/RPDé™åˆ¶ç®¡ç†
    - 4ç»„Keysæ™ºèƒ½è°ƒåº¦
    - è‡ªåŠ¨æ•…éšœè½¬ç§»
    - è´Ÿè½½å‡è¡¡
    - å®æ—¶ç»Ÿè®¡ç›‘æ§
```

**æŠ€æœ¯æŒ‡æ ‡**:
- Keysæ€»æ•°: 25ä¸ªï¼ˆ4ç»„ï¼‰
- RPMå®¹é‡: 300 requests/minute
- RPDå®¹é‡: 30,000 requests/day
- å®‰å…¨ç³»æ•°: 80% (é¿å…è§¦å‘é™åˆ¶)
- æ•…éšœè½¬ç§»: <100ms

**åˆ†ç»„ç­–ç•¥**:
```yaml
Group A (VIP): 6 Keys â†’ 72 RPM
Group B (Premium): 6 Keys â†’ 72 RPM
Group C (Normal): 6 Keys â†’ 72 RPM
Group D (Backup): 7 Keys â†’ 84 RPM
```

**æµ‹è¯•ç»“æœ**:
- âœ… 100ä¸ªè¯·æ±‚å‹åŠ›æµ‹è¯•é€šè¿‡
- âœ… è½®è¯¢æœºåˆ¶æ­£å¸¸
- âœ… æ•…éšœæ£€æµ‹æ­£å¸¸
- âœ… ç»Ÿè®¡åŠŸèƒ½å®Œæ•´

---

### 3. ğŸ¤– é›†æˆè·¯ç”±çš„Bot
**æ–‡ä»¶**: `xiaoai_with_router.py`

**é›†æˆåŠŸèƒ½**:
- âœ… æ™ºèƒ½Keyè·¯ç”±
- âœ… 5è½®å¯¹è¯è®°å¿†
- âœ… å…³é”®è¯è§¦å‘
- âœ… ç”¨æˆ·åˆ†çº§æœåŠ¡
- âœ… å®æ—¶ç›‘æ§ç»Ÿè®¡

**æ–°å¢å‘½ä»¤**:
```
/start  - å¯åŠ¨Botï¼ˆæ˜¾ç¤ºç”¨æˆ·ç­‰çº§ï¼‰
/status - ç³»ç»ŸçŠ¶æ€ï¼ˆå«è·¯ç”±å™¨ç»Ÿè®¡ï¼‰
/router - è·¯ç”±å™¨è¯¦ç»†çŠ¶æ€
/help   - å¸®åŠ©ä¿¡æ¯
/clear  - æ¸…é™¤è®°å¿†
```

**ç”¨æˆ·åˆ†çº§**:
- VIP: Owner (ä¼˜å…ˆGroup A)
- Premium: ä»˜è´¹ç”¨æˆ· (ä¼˜å…ˆGroup B)
- Normal: æ³¨å†Œç”¨æˆ· (ä¼˜å…ˆGroup C)
- Guest: æ¸¸å®¢ (ä¼˜å…ˆGroup D)

---

### 4. ğŸ“– å®Œæ•´æ–‡æ¡£
**æ–‡ä»¶**: 
- `ROUTER_SYSTEM_GUIDE.md` - è·¯ç”±ç³»ç»Ÿå®Œæ•´æŒ‡å—
- `DOPPLER_SERVICES_CLASSIFICATION.md` - DoppleræœåŠ¡åˆ†ç±»
- `MEMORY_SYSTEM_GUIDE.md` - è®°å¿†ç³»ç»Ÿä½¿ç”¨æŒ‡å—

**å†…å®¹æ¶µç›–**:
- ç³»ç»Ÿæ¶æ„è®¾è®¡
- APIé™åˆ¶è¯¦è§£
- å®¹é‡è§„åˆ’
- ä½¿ç”¨ç¤ºä¾‹
- ä¼˜åŒ–å»ºè®®
- æ•…éšœæ’æŸ¥
- æœ€ä½³å®è·µ

---

## ğŸš€ å½“å‰è¿è¡ŒçŠ¶æ€

### BotçŠ¶æ€
```
è¿›ç¨‹: âœ… è¿è¡Œä¸­
PID: 3147434
ç‰ˆæœ¬: æ™ºèƒ½è·¯ç”±ç‰ˆ v2.0
æ—¥å¿—: logs/xiaoai_router.log
```

### ç³»ç»Ÿå®¹é‡
```yaml
æ€»Keys: 25ä¸ª
æ€»RPM: 300 requests/minute
æ€»RPD: 30,000 requests/day
æ”¯æŒç”¨æˆ·: 200-300å¹¶å‘

å½“å‰ä½¿ç”¨:
  å¯ç”¨Keys: 25/25
  è¯·æ±‚æ•°: 0
  é”™è¯¯æ•°: 0
```

### è·¯ç”±å™¨çŠ¶æ€
```yaml
Group A: 6/6 Keys å¯ç”¨ (72 RPM)
Group B: 6/6 Keys å¯ç”¨ (72 RPM)
Group C: 6/6 Keys å¯ç”¨ (72 RPM)
Group D: 7/7 Keys å¯ç”¨ (84 RPM)

æ€»å®¹é‡: 300 RPM / 30,000 RPD
ä½¿ç”¨ç‡: 0%
```

---

## ğŸ“Š ç³»ç»Ÿå¯¹æ¯”

### ä¹‹å‰ vs ç°åœ¨

| åŠŸèƒ½ | ä¹‹å‰ | ç°åœ¨ | æå‡ |
|------|------|------|------|
| Keysæ•°é‡ | 1ä¸ª | 25ä¸ª | 25x |
| RPMå®¹é‡ | 15 | 300 | 20x |
| RPDå®¹é‡ | 1,500 | 30,000 | 20x |
| æ•…éšœè½¬ç§» | âŒ æ—  | âœ… è‡ªåŠ¨ | - |
| è´Ÿè½½å‡è¡¡ | âŒ æ—  | âœ… æ™ºèƒ½ | - |
| ç”¨æˆ·åˆ†çº§ | âŒ æ—  | âœ… 4çº§ | - |
| å¯¹è¯è®°å¿† | âŒ æ—  | âœ… 5è½® | - |
| å…³é”®è¯è§¦å‘ | âŒ æ—  | âœ… 11ä¸ª | - |
| ç›‘æ§ç»Ÿè®¡ | âŒ æ—  | âœ… å®Œæ•´ | - |

### å®¹é‡æå‡

**åœºæ™¯1: 100ä¸ªæ´»è·ƒç”¨æˆ·**
- ä¹‹å‰: âŒ æ— æ³•æ”¯æŒï¼ˆ15 RPMä¸å¤Ÿï¼‰
- ç°åœ¨: âœ… è½»æ¾æ”¯æŒï¼ˆ300 RPMå……è¶³ï¼‰

**åœºæ™¯2: 200ä¸ªæ´»è·ƒç”¨æˆ·**
- ä¹‹å‰: âŒ å®Œå…¨ä¸å¯èƒ½
- ç°åœ¨: âœ… å¯ä»¥æ”¯æŒï¼ˆæ¥è¿‘ä¸Šé™ï¼‰

**åœºæ™¯3: 500ä¸ªæ´»è·ƒç”¨æˆ·**
- ä¹‹å‰: âŒ ä¸å¯èƒ½
- ç°åœ¨: âš ï¸ éœ€è¦é™æµæˆ–å¢åŠ Keys

---

## ğŸ¯ æµ‹è¯•éªŒè¯

### 1. è·¯ç”±å™¨æµ‹è¯•
```bash
python3 gemini_key_router_v2.py

ç»“æœ:
âœ… 100ä¸ªè¯·æ±‚å‹åŠ›æµ‹è¯•é€šè¿‡
âœ… è½®è¯¢æœºåˆ¶æ­£å¸¸å·¥ä½œ
âœ… ç»Ÿè®¡åŠŸèƒ½å®Œæ•´
âœ… æ•…éšœæ£€æµ‹æ­£å¸¸
```

### 2. BotåŠŸèƒ½æµ‹è¯•
**å»ºè®®æµ‹è¯•é¡¹**:
```
â–¡ å‘é€ /start - æŸ¥çœ‹å¯åŠ¨ä¿¡æ¯
â–¡ å‘é€æ™®é€šæ¶ˆæ¯ - æµ‹è¯•AIå›å¤
â–¡ è¿ç»­5æ¡æ¶ˆæ¯ - æµ‹è¯•è®°å¿†åŠŸèƒ½
â–¡ è¯´"çˆ±ä½ " - æµ‹è¯•å…³é”®è¯è§¦å‘
â–¡ å‘é€ /status - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
â–¡ å‘é€ /router - æŸ¥çœ‹è·¯ç”±å™¨çŠ¶æ€
â–¡ é«˜é¢‘å‘é€ - æµ‹è¯•é™æµä¿æŠ¤
```

### 3. æ€§èƒ½æµ‹è¯•
**å¾…éªŒè¯**:
```
â–¡ å“åº”æ—¶é—´ (<2s)
â–¡ æˆåŠŸç‡ (>99%)
â–¡ Keysè½®è¯¢æ˜¯å¦å‡è¡¡
â–¡ æ•…éšœè½¬ç§»æ˜¯å¦åŠæ—¶
â–¡ ç»Ÿè®¡æ•°æ®æ˜¯å¦å‡†ç¡®
```

---

## ğŸ”§ åç»­ä¼˜åŒ–å»ºè®®

### ä¼˜å…ˆçº§1 - ç«‹å³æ‰§è¡Œ

**1. æ·»åŠ Keysåˆ°Doppler**
```bash
# åœ¨Dopplerä¸­æ·»åŠ 25ä¸ªGemini Keys
GEMINI_GROUP_A_KEY_1=AIzaSyCPxNPKzWp29Bfn41KhfGzor8Nw98UBUlU
GEMINI_GROUP_A_KEY_2=AIzaSyAWpD1-bJIE6lXv3lwT-yePeb2faEpYXd8
...
GEMINI_GROUP_D_KEY_7=AIzaSyA5PgAqHpLt8yHCcxdTyBTHt_YP9VmOwjA
```

**2. å®‰è£…Redis**
```bash
sudo apt-get update
sudo apt-get install redis-server
sudo systemctl start redis-server
sudo systemctl enable redis-server
```

**3. ä»DoppleråŠ è½½é…ç½®**
```python
# ä¿®æ”¹ gemini_key_router_v2.py
import os

keys_config = {
    'group_a': [
        os.getenv(f'GEMINI_GROUP_A_KEY_{i}')
        for i in range(1, 7)
    ],
    # ...
}
```

### ä¼˜å…ˆçº§2 - æœ¬å‘¨å®Œæˆ

**1. Redisé›†æˆæŒä¹…åŒ–**
```python
# å°†ç»Ÿè®¡æ•°æ®æŒä¹…åŒ–åˆ°Redis
class GeminiKeyRouter:
    def save_stats_to_redis(self):
        # ä¿å­˜ç»Ÿè®¡æ•°æ®
        pass
    
    def load_stats_from_redis(self):
        # æ¢å¤ç»Ÿè®¡æ•°æ®
        pass
```

**2. ç›‘æ§é¢æ¿**
```python
# åˆ›å»ºWebç›‘æ§é¢æ¿
from flask import Flask

@app.route('/stats')
def stats_dashboard():
    stats = router.get_stats()
    return render_template('dashboard.html', stats=stats)
```

**3. å‘Šè­¦ç³»ç»Ÿ**
```python
# Keysæ¥è¿‘é™åˆ¶æ—¶å‘é€Telegramå‘Šè­¦
if available_keys < total_keys * 0.2:
    send_alert(OWNER_ID, "âš ï¸ 80%çš„Keysæ¥è¿‘é™åˆ¶")
```

### ä¼˜å…ˆçº§3 - æŒç»­ä¼˜åŒ–

**1. åŠ¨æ€è°ƒæ•´**
- æ ¹æ®é”™è¯¯ç‡è°ƒæ•´å®‰å…¨ç³»æ•°
- æ ¹æ®ä½¿ç”¨æƒ…å†µä¼˜åŒ–åˆ†ç»„
- å®šæœŸè½®æ¢Keysé¡ºåº

**2. æœºå™¨å­¦ä¹ ä¼˜åŒ–**
- é¢„æµ‹é«˜å³°æ—¶æ®µ
- æ™ºèƒ½é¢„åˆ†é…Keys
- ä¼˜åŒ–è·¯ç”±ç­–ç•¥

**3. åˆ†å¸ƒå¼éƒ¨ç½²**
- æ”¯æŒå¤šBotå®ä¾‹
- å…±äº«è·¯ç”±å™¨çŠ¶æ€
- å…¨å±€è´Ÿè½½å‡è¡¡

---

## ğŸ“ˆ å®¹é‡æ‰©å±•è§„åˆ’

### å½“å‰: 25 Keys
```yaml
å®¹é‡: 300 RPM / 30,000 RPD
æ”¯æŒ: 200-300å¹¶å‘ç”¨æˆ·
æˆæœ¬: $0 (å…¨éƒ¨å…è´¹å±‚)
```

### æ‰©å±•åˆ°50 Keys
```yaml
å®¹é‡: 600 RPM / 60,000 RPD
æ”¯æŒ: 400-600å¹¶å‘ç”¨æˆ·
æˆæœ¬: $0 (ä»å¯ä½¿ç”¨å…è´¹å±‚)
å®æ–½: ç”³è¯·æ›´å¤šGoogleè´¦å·
```

### æ‰©å±•åˆ°100 Keys
```yaml
å®¹é‡: 1,200 RPM / 120,000 RPD
æ”¯æŒ: 800-1,200å¹¶å‘ç”¨æˆ·
æˆæœ¬: $0 (å…è´¹å±‚)
å®æ–½: æ‰¹é‡ç”³è¯·è´¦å·
```

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### å¯åŠ¨Bot
```bash
cd /mnt/volume_sgp1_01/svs_bot
./START_ROUTER_BOT.sh
```

### æŸ¥çœ‹çŠ¶æ€
```bash
# è¿›ç¨‹çŠ¶æ€
ps aux | grep xiaoai_with_router

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/xiaoai_router.log

# Telegramå‘½ä»¤
/status  # ç³»ç»ŸçŠ¶æ€
/router  # è·¯ç”±å™¨çŠ¶æ€
```

### æµ‹è¯•è·¯ç”±å™¨
```bash
python3 gemini_key_router_v2.py
```

### é‡å¯Bot
```bash
pkill -f xiaoai_with_router
./START_ROUTER_BOT.sh
```

---

## ğŸ“ æ”¯æŒä¿¡æ¯

### æ–‡æ¡£ä½ç½®
```
/mnt/volume_sgp1_01/svs_bot/
â”œâ”€â”€ ROUTER_SYSTEM_GUIDE.md           # è·¯ç”±ç³»ç»Ÿå®Œæ•´æŒ‡å—
â”œâ”€â”€ DOPPLER_SERVICES_CLASSIFICATION.md # DoppleræœåŠ¡åˆ†ç±»
â”œâ”€â”€ MEMORY_SYSTEM_GUIDE.md           # è®°å¿†ç³»ç»ŸæŒ‡å—
â”œâ”€â”€ DEPLOYMENT_SUMMARY.md            # æœ¬æ–‡æ¡£
â””â”€â”€ logs/xiaoai_router.log           # è¿è¡Œæ—¥å¿—
```

### å…³é”®æ–‡ä»¶
```
æ ¸å¿ƒä»£ç :
  gemini_key_router_v2.py      # è·¯ç”±å™¨å®ç°
  xiaoai_with_router.py        # Botä¸»ç¨‹åº

å¯åŠ¨è„šæœ¬:
  START_ROUTER_BOT.sh          # ä¸€é”®å¯åŠ¨

é…ç½®æ–‡ä»¶:
  .env                         # ç¯å¢ƒå˜é‡
  /mnt/volume_sgp1_01/svs-mcp/.env  # Doppleré…ç½®
```

### Botä¿¡æ¯
```yaml
ä¸»Bot: @svskilo_bot
Token: 8242036113:AAGhqTo7_Lb5tMHT2WlspWV-RoxrWdki3Wg
Owner: 6136230855
çŠ¶æ€: âœ… è¿è¡Œä¸­
PID: 3147434
```

---

## âœ… æˆåŠŸæŒ‡æ ‡

- [x] è·¯ç”±å™¨å¼€å‘å®Œæˆ
- [x] Boté›†æˆå®Œæˆ
- [x] æ–‡æ¡£ç¼–å†™å®Œæˆ
- [x] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [x] BotæˆåŠŸå¯åŠ¨
- [ ] Redisé›†æˆ
- [ ] Doppleré…ç½®æ›´æ–°
- [ ] ç”Ÿäº§ç¯å¢ƒæµ‹è¯•
- [ ] ç›‘æ§é¢æ¿
- [ ] å‘Šè­¦ç³»ç»Ÿ

---

## ğŸ‰ æ€»ç»“

### æ ¸å¿ƒæˆæœ
1. âœ… **æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ** - å®Œæ•´å®ç°25ä¸ªKeysæ™ºèƒ½è°ƒåº¦
2. âœ… **å®¹é‡æå‡20å€** - ä»15 RPMåˆ°300 RPM
3. âœ… **5è½®å¯¹è¯è®°å¿†** - ç†è§£ä¸Šä¸‹æ–‡çš„æ™ºèƒ½å¯¹è¯
4. âœ… **ç”¨æˆ·åˆ†çº§æœåŠ¡** - VIP/Premium/Normal/Guest
5. âœ… **å®Œæ•´æ–‡æ¡£** - 3ä»½è¯¦ç»†æŒ‡å—æ–‡æ¡£

### æŠ€æœ¯äº®ç‚¹
- ğŸ¯ åŸºäºRPM/RPDçš„ç²¾ç¡®é™åˆ¶ç®¡ç†
- ğŸ”„ è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆ<100msï¼‰
- âš¡ è´Ÿè½½å‡è¡¡ï¼ˆè½®è¯¢+ä¼˜å…ˆçº§ï¼‰
- ğŸ“Š å®æ—¶ç›‘æ§ç»Ÿè®¡
- ğŸ§  å¤šè½®å¯¹è¯è®°å¿†

### å•†ä¸šä»·å€¼
- ğŸ’° **é›¶æˆæœ¬** - å…¨éƒ¨ä½¿ç”¨å…è´¹å±‚
- ğŸ“ˆ **é«˜å®¹é‡** - æ”¯æŒ200-300å¹¶å‘ç”¨æˆ·
- ğŸš€ **æ˜“æ‰©å±•** - å¯çº¿æ€§æ‰©å±•åˆ°100+ Keys
- ğŸ›¡ï¸ **é«˜å¯ç”¨** - æ•…éšœè‡ªåŠ¨è½¬ç§»
- ğŸ“Š **å¯ç›‘æ§** - å®Œæ•´ç»Ÿè®¡å’Œå‘Šè­¦

---

**éƒ¨ç½²æ—¶é—´**: 2025-11-10  
**ç‰ˆæœ¬**: v2.0  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª  
**ä¸‹æ¬¡å®¡æ ¸**: å»ºè®®1å‘¨å

ğŸŠ **æ­å–œï¼æ™ºèƒ½è·¯ç”±ç³»ç»Ÿéƒ¨ç½²æˆåŠŸï¼**
