# ğŸ—ï¸ DeepWeay å¾®æœåŠ¡å®¹å™¨æ¶æ„

**ç‰ˆæœ¬**: 2.0  
**æ›´æ–°**: 2025-11-06  
**æ¨¡å¼**: å¿«é€ŸåŸå‹å¼€å‘ â†’ å‡æ•°æ® â†’ åç»­çœŸå®æ•°æ®

---

## ğŸ“¦ å®¹å™¨åˆ’åˆ†ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginx (80/443)                       â”‚
â”‚              SSL + åå‘ä»£ç† + è·¯ç”±åˆ†å‘                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»ç«™å®¹å™¨     â”‚    â”‚  BBSå®¹å™¨      â”‚    â”‚ AIå·¥å…·å®¹å™¨    â”‚
â”‚  (Next.js)   â”‚    â”‚  (Forum API)  â”‚    â”‚ (AI Services)â”‚
â”‚  Port: 3000  â”‚    â”‚  Port: 3001   â”‚    â”‚  Port: 3002  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Botå®¹å™¨ (3-in-1)              â”‚
â”‚  - TG Bot 1: svsinst_bot             â”‚
â”‚  - TG Bot 2: svslovea_bot            â”‚
â”‚  - Slack Bot: deepweay-bot           â”‚
â”‚  Port: å†…éƒ¨é€šä¿¡ (æ— éœ€æš´éœ²)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å¤–éƒ¨æœåŠ¡                      â”‚
â”‚  - Supabase (Auth + DB + Storage)    â”‚
â”‚  - Gemini AI (AIåŠŸèƒ½)                â”‚
â”‚  - Datadog (ç›‘æ§)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å®¹å™¨èŒè´£åˆ’åˆ†

### 1ï¸âƒ£ **ä¸»ç«™å®¹å™¨** (web-main)
**æŠ€æœ¯æ ˆ**: Next.js 15 + React 19 + TailwindCSS  
**ç«¯å£**: 3000 (å†…éƒ¨)  
**èŒè´£**:
- âœ… **é¦–é¡µ** (`/`) - é™æ€å±•ç¤ºé¡µ + 6ç¯‡æ–‡ç« é¢„è§ˆ + 6ä¸ªAIå·¥å…·teaser
- âœ… **ç™»å½•/æ³¨å†Œ** (`/login`) - Supabase Auth
- âœ… **ç”¨æˆ·ä¸­å¿ƒ** (`/dashboard`) - ä¸ªäººä¿¡æ¯ + é‚€è¯·ç ç®¡ç†
- âœ… **æ–‡ç« ç³»ç»Ÿ** (`/articles/*`) - é˜…è¯»é•¿æ–‡
- ğŸ”€ **è·¯ç”±æ¢çº½** - è·³è½¬åˆ°BBSã€AIå·¥å…·å®¹å™¨

**ç‰¹ç‚¹**:
- Server Componentsä¼˜å…ˆ
- é™æ€é¡µé¢é¢„æ¸²æŸ“
- å‡æ•°æ®å¿«é€ŸåŸå‹ï¼š`src/lib/mock-data.ts`

---

### 2ï¸âƒ£ **BBSå®¹å™¨** (web-bbs)
**æŠ€æœ¯æ ˆ**: Next.js 15 + React 19 (ç‹¬ç«‹å®ä¾‹)  
**ç«¯å£**: 3001 (å†…éƒ¨)  
**è·¯ç”±**: `/bbs/*` â†’ Nginxè½¬å‘åˆ° `http://web-bbs:3001`

**èŒè´£**:
- âœ… **è®ºå›åˆ—è¡¨** (`/bbs`) - å¸–å­æµ
- âœ… **å‘å¸–** (`/bbs/new`) - åˆ›å»ºæ–°å¸–
- âœ… **å¸–å­è¯¦æƒ…** (`/bbs/[id]`) - é˜…è¯» + å›å¤
- âœ… **ç”¨æˆ·äº’åŠ¨** - ç‚¹èµã€æ”¶è—ã€ä¸¾æŠ¥

**æ•°æ®æ¥æº**:
- é˜¶æ®µ1: `mock-bbs-data.json` (å‡æ•°æ®)
- é˜¶æ®µ2: Supabase `bbs_posts` + `bbs_replies` (çœŸå®æ•°æ®)

**ç‹¬ç«‹åŸå› **:
- è®ºå›æ˜¯é«˜é¢‘äº¤äº’åœºæ™¯ï¼Œç‹¬ç«‹å®¹å™¨ä¾¿äºæ‰©å±•
- å¯ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹ç¼“å­˜ç­–ç•¥
- æœªæ¥å¯åˆ‡æ¢åˆ°ä¸“ä¸šè®ºå›æ¡†æ¶ï¼ˆDiscourseç­‰ï¼‰

---

### 3ï¸âƒ£ **AIå·¥å…·å®¹å™¨** (web-ai-tools)
**æŠ€æœ¯æ ˆ**: Next.js 15 + Genkit + Gemini AI  
**ç«¯å£**: 3002 (å†…éƒ¨)  
**è·¯ç”±**: `/ai-tools/*` â†’ Nginxè½¬å‘åˆ° `http://web-ai-tools:3002`

**èŒè´£**:
- âœ… **ç­¾è¯åŠ©æ‰‹** (`/ai-tools/visa-assistant`) - AIå¯¹è¯
- âœ… **ç­¾è¯å¯¹æ¯”** (`/ai-tools/visa-comparison`) - å¤šå›½å¯¹æ¯”
- âœ… **ç”Ÿæ´»æˆæœ¬** (`/ai-tools/cost-of-living`) - åŸå¸‚æˆæœ¬è®¡ç®—
- âœ… **è¡Œç¨‹è§„åˆ’** (`/ai-tools/planner`) - AIç”Ÿæˆæ—…è¡Œè®¡åˆ’
- âœ… **æ–‡æ¡£ç”Ÿæˆ** (`/ai-tools/doc-generator`) - è‡ªåŠ¨ç”Ÿæˆç­¾è¯ææ–™
- âœ… **ç¤¾ç¾¤æ¨è** (`/ai-tools/community-finder`) - åŒ¹é…æ•°å­—æ¸¸æ°‘ç¤¾ç¾¤

**æ•°æ®æ¥æº**:
- é˜¶æ®µ1: å‡çš„AIå“åº” (`mock-ai-responses.json`)
- é˜¶æ®µ2: Gemini 2.5 Flash API (çœŸå®AI)

**ç‹¬ç«‹åŸå› **:
- AIè°ƒç”¨è€—æ—¶ï¼Œç‹¬ç«‹å®¹å™¨é¿å…é˜»å¡ä¸»ç«™
- PROä¼šå‘˜é™æµç­–ç•¥ç‹¬ç«‹ç®¡ç†
- å¯ç‹¬ç«‹ç›‘æ§AI APIé…é¢

---

### 4ï¸âƒ£ **Botå®¹å™¨** (bots-unified)
**æŠ€æœ¯æ ˆ**: Node.js + Telegraf + Bolt (Slack SDK)  
**ç«¯å£**: æ— éœ€æš´éœ²ï¼ˆå†…éƒ¨é€šä¿¡ï¼‰

**Botsåˆ—è¡¨**:
1. **TG Bot 1** - `@svsinst_bot` (å°çˆ±åŒå­¦)
   - åŠŸèƒ½ï¼šç¤¾ç¾¤åŠ©æ‰‹ + å¿«é€ŸæŸ¥è¯¢
2. **TG Bot 2** - `@svslovea_bot` (å¤‡ç”¨)
   - åŠŸèƒ½ï¼šå¤‡ç”¨bot + A/Bæµ‹è¯•
3. **Slack Bot** - `deepweay-bot`
   - åŠŸèƒ½ï¼šä¼ä¸šç¤¾ç¾¤ç®¡ç†

**é€šä¿¡æ–¹å¼**:
```
ç”¨æˆ· â†’ Telegram/Slack â†’ Botå®¹å™¨ â†’ Supabase/ä¸»ç«™API
```

**èŒè´£**:
- âœ… æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯
- âœ… è°ƒç”¨ä¸»ç«™APIè·å–æ•°æ®
- âœ… è¿”å›æ ¼å¼åŒ–å›å¤
- âœ… Webhookæ¥æ”¶ (Nginx â†’ Botå®¹å™¨)

**ç‹¬ç«‹åŸå› **:
- Botéœ€è¦24/7è¿è¡Œï¼Œä¸Webå®¹å™¨ç”Ÿå‘½å‘¨æœŸè§£è€¦
- Webhookè·¯ç”±ç‹¬ç«‹ï¼š`/webhook/tg-bot-1`, `/webhook/tg-bot-2`, `/webhook/slack`
- å¯ç‹¬ç«‹é‡å¯ä¸å½±å“ç½‘ç«™

---

## ğŸŒ Nginxè·¯ç”±é…ç½®

```nginx
# ä¸»ç«™ï¼ˆé»˜è®¤ï¼‰
location / {
    proxy_pass http://web-main:3000;
}

# ç™»å½•ï¼ˆä¸»ç«™ï¼‰
location /login {
    proxy_pass http://web-main:3000;
}

# Dashboardï¼ˆä¸»ç«™ï¼‰
location /dashboard {
    proxy_pass http://web-main:3000;
}

# æ–‡ç« ï¼ˆä¸»ç«™ï¼‰
location /articles {
    proxy_pass http://web-main:3000;
}

# è®ºå›ï¼ˆBBSå®¹å™¨ï¼‰
location /bbs {
    proxy_pass http://web-bbs:3001;
}

# AIå·¥å…·ï¼ˆAIå®¹å™¨ï¼‰
location /ai-tools {
    proxy_pass http://web-ai-tools:3002;
}

# Bot Webhooksï¼ˆBotå®¹å™¨ï¼‰
location /webhook/ {
    proxy_pass http://bots-unified:4000;
}

# Health Checks
location /health {
    proxy_pass http://web-main:3000/api/health;
}
```

---

## ğŸ“‚ é¡¹ç›®ç›®å½•ç»“æ„ï¼ˆé‡æ„åï¼‰

```
studio/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ docker-compose.yml           # å¤šå®¹å™¨ç¼–æ’
â”œâ”€â”€ .env.production.template     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚
â”œâ”€â”€ services/                    # å¾®æœåŠ¡ç›®å½•
â”‚   â”œâ”€â”€ web-main/                # ä¸»ç«™
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # é¦–é¡µ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ articles/
â”‚   â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚   â”‚       â””â”€â”€ mock-data.ts          # å‡æ•°æ®
â”‚   â”‚   â””â”€â”€ public/
â”‚   â”‚
â”‚   â”œâ”€â”€ web-bbs/                 # è®ºå›å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ bbs/
â”‚   â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚   â”‚       â””â”€â”€ mock-bbs-data.json    # å‡æ•°æ®
â”‚   â”‚   â””â”€â”€ public/
â”‚   â”‚
â”‚   â”œâ”€â”€ web-ai-tools/            # AIå·¥å…·å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ai-tools/
â”‚   â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚   â”‚       â””â”€â”€ mock-ai-responses.json # å‡æ•°æ®
â”‚   â”‚   â””â”€â”€ ai/                  # Genkité…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ bots-unified/            # ç»Ÿä¸€Botå®¹å™¨
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ telegram/
â”‚       â”‚   â”‚   â”œâ”€â”€ bot1.ts      # @svsinst_bot
â”‚       â”‚   â”‚   â””â”€â”€ bot2.ts      # @svslovea_bot
â”‚       â”‚   â”œâ”€â”€ slack/
â”‚       â”‚   â”‚   â””â”€â”€ bot.ts       # deepweay-bot
â”‚       â”‚   â””â”€â”€ shared/
â”‚       â”‚       â””â”€â”€ api-client.ts # è°ƒç”¨ä¸»ç«™API
â”‚       â””â”€â”€ webhooks.ts          # WebhookæœåŠ¡å™¨
â”‚
â”œâ”€â”€ nginx/                       # Nginxé…ç½®
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ nginx.conf               # è·¯ç”±è§„åˆ™
â”‚
â”œâ”€â”€ database/                    # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ schema.sql               # Supabase schema
â”‚   â””â”€â”€ migrations/
â”‚
â”œâ”€â”€ scripts/                     # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ tests/                   # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ dev/                     # å¼€å‘è„šæœ¬
â”‚
â””â”€â”€ docs/                        # æ–‡æ¡£
    â”œâ”€â”€ archived/                # å†å²æ–‡æ¡£
    â””â”€â”€ api/                     # APIæ–‡æ¡£
```

---

## ğŸš€ å¿«é€ŸåŸå‹å¼€å‘æµç¨‹

### **é˜¶æ®µ1: å‡æ•°æ®åŸå‹**ï¼ˆç°åœ¨ï¼‰

```bash
# 1. åˆ›å»ºMockæ•°æ®
services/web-main/src/lib/mock-data.ts
services/web-bbs/src/lib/mock-bbs-data.json
services/web-ai-tools/src/lib/mock-ai-responses.json

# 2. å®ç°UI + å‡è·¯ç”±
- ä¸»ç«™ï¼šå±•ç¤ºå‡æ–‡ç« ã€å‡ç”¨æˆ·ä¿¡æ¯
- BBSï¼šå‡å¸–å­åˆ—è¡¨ã€å‡å›å¤
- AIå·¥å…·ï¼šè¿”å›é¢„è®¾çš„AIå“åº”

# 3. å®¹å™¨é—´è·³è½¬
- ä½¿ç”¨ç¡¬ç¼–ç URLè·³è½¬
- æ— éœ€çœŸå®APIè°ƒç”¨
- ä¸“æ³¨UI/UXå®Œå–„
```

### **é˜¶æ®µ2: çœŸå®æ•°æ®é›†æˆ**ï¼ˆéƒ¨ç½²å‰ï¼‰

```bash
# 1. æ›¿æ¢Mockæ•°æ®ä¸ºçœŸå®API
- ä¸»ç«™ï¼šè¿æ¥Supabase Auth + Usersè¡¨
- BBSï¼šè¿æ¥Supabase bbs_postsè¡¨
- AIå·¥å…·ï¼šè¿æ¥Gemini API

# 2. å®ç°å®¹å™¨é—´APIé€šä¿¡
- åˆ›å»º /api/* endpoints
- ç»Ÿä¸€è®¤è¯ä¸­é—´ä»¶
- è·¨åŸŸé…ç½®

# 3. æœ¬åœ°æµ‹è¯•å®Œæ•´æµç¨‹
docker-compose up --build
```

### **é˜¶æ®µ3: VPSéƒ¨ç½²**ï¼ˆæœ€åï¼‰

```bash
# 1. é…ç½®ç¯å¢ƒå˜é‡
cp .env.production.template .env.production

# 2. éƒ¨ç½²åˆ°GitHub
git push origin main

# 3. VPSæ‹‰å–éƒ¨ç½²
ssh root@165.227.50.171
cd /root/studio
git pull
docker-compose up -d --build
```

---

## ğŸ­ å®¹å™¨åŒ–ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **ç‹¬ç«‹å¼€å‘** | æ¯ä¸ªå®¹å™¨å¯ä»¥ç‹¬ç«‹å¼€å‘ã€æµ‹è¯• |
| **ç‹¬ç«‹éƒ¨ç½²** | å¯ä»¥å•ç‹¬æ›´æ–°æŸä¸ªæœåŠ¡ï¼Œä¸å½±å“å…¶ä»– |
| **ç‹¬ç«‹æ‰©å±•** | BBSæµé‡å¤§ï¼Ÿåªæ‰©å±•BBSå®¹å™¨ |
| **æ•…éšœéš”ç¦»** | AIæœåŠ¡æŒ‚äº†ä¸å½±å“ä¸»ç«™ |
| **æŠ€æœ¯è‡ªç”±** | æœªæ¥å¯ä»¥ç”¨ä¸åŒè¯­è¨€é‡å†™æŸä¸ªæœåŠ¡ |
| **æˆæœ¬ä¼˜åŒ–** | å¼€å‘æ—¶åªå¯åŠ¨éœ€è¦çš„å®¹å™¨ |

---

## ğŸ’° æˆæœ¬æ§åˆ¶ç­–ç•¥

### **å¼€å‘é˜¶æ®µ**ï¼ˆVPSï¼‰
```bash
# åªå¯åŠ¨éœ€è¦çš„å®¹å™¨
docker-compose up web-main web-bbs  # å¼€å‘è®ºå›æ—¶

# åœæ­¢ä¸éœ€è¦çš„æœåŠ¡
docker-compose stop web-ai-tools bots-unified
```

### **åŸå‹å®Œæˆå**
```bash
# å…³é—­VPS
# æœ¬åœ°ç»§ç»­å¼€å‘
docker-compose -f docker-compose.dev.yml up
```

### **æ­£å¼éƒ¨ç½²**
```bash
# ä½¿ç”¨GitHub Actionsè‡ªåŠ¨éƒ¨ç½²
# æˆ–ä½¿ç”¨Vercelç­‰PaaSå¹³å°
```

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… **æ¸…ç†æ ¹ç›®å½•** â† å·²å®Œæˆ
2. ğŸ”„ **é‡æ„é¡¹ç›®ç»“æ„** â† è¿›è¡Œä¸­
3. ğŸ“¦ **åˆ›å»ºå¾®æœåŠ¡docker-compose.yml**
4. ğŸ¨ **å®ç°ä¸»ç«™é¦–é¡µï¼ˆå‡æ•°æ®ï¼‰**
5. ğŸ’¬ **å®ç°BBSå®¹å™¨ï¼ˆå‡æ•°æ®ï¼‰**
6. ğŸ¤– **å®ç°AIå·¥å…·å®¹å™¨ï¼ˆå‡æ•°æ®ï¼‰**
7. ğŸ”— **å®ç°Botå®¹å™¨**
8. ğŸ§ª **å®¹å™¨é—´é€šä¿¡æµ‹è¯•**
9. ğŸ’¾ **Gitæäº¤å­˜æ¡£**

---

**æ›´æ–°æ—¥æœŸ**: 2025-11-06  
**çŠ¶æ€**: ğŸš§ æ¶æ„è®¾è®¡å®Œæˆï¼Œå‡†å¤‡å®æ–½
