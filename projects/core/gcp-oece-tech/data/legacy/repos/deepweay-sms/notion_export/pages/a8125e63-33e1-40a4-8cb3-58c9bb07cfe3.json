{"object":"list","results":[{"object":"block","id":"046b0f34-8429-4291-b038-752302afa9e8","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"系统概述","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"系统概述","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0c0be2c9-3adf-46dd-b254-c5702ec6aeda","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"这是一个基于 5 个 AI Agent 并发推理的决策支持系统，通过不同角色的 AI 模型进行多维度分析，最终由仲裁者生成纳什均衡解决方案。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"这是一个基于 5 个 AI Agent 并发推理的决策支持系统，通过不同角色的 AI 模型进行多维度分析，最终由仲裁者生成纳什均衡解决方案。","href":null}],"color":"default"}},{"object":"block","id":"5bf846b2-1d83-4196-b79e-0428e0918731","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"核心设计理念","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"核心设计理念","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"7b518924-40a9-4364-b196-69eea9ce4e94","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Key 1-4","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Key 1-4","href":null},{"type":"text","text":{"content":"：本地运行 Yi-6B INT8 模型，零成本并发推理","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"：本地运行 Yi-6B INT8 模型，零成本并发推理","href":null}],"color":"default"}},{"object":"block","id":"77e4ffc6-2c2d-4c51-b032-e0c81eadb909","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Key 5","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Key 5","href":null},{"type":"text","text":{"content":"：调用 Gemini API 作为最终决策者","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"：调用 Gemini API 作为最终决策者","href":null}],"color":"default"}},{"object":"block","id":"9124270e-be3d-457c-9d9a-f8734ce0a2a6","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"成本控制","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"成本控制","href":null},{"type":"text","text":{"content":"：$0.02-0.05 per 决策，混合架构降低 95% 成本","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"：$0.02-0.05 per 决策，混合架构降低 95% 成本","href":null}],"color":"default"}},{"object":"block","id":"6a961fa1-d273-450d-a19d-9f611275c5c8","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"部署方式","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"部署方式","href":null},{"type":"text","text":{"content":"：Mac 本地 + GCP Cloud Run（可选）","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"：Mac 本地 + GCP Cloud Run（可选）","href":null}],"color":"default"}},{"object":"block","id":"0654954e-519c-467a-8c38-5502a11ba063","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"9a41055b-aacb-4095-a87e-4a28ff442434","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"技术栈","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"技术栈","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"cfcbe6cc-8c0b-49fc-9821-4f4706a8f93e","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"核心技术","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"核心技术","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"41454bb8-5d70-4b17-ba8f-ca00e18ddbcb","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"编程语言: Go 1.21+\n本地推理引擎: llama.cpp\n模型: Yi-6B-Chat GGUF INT8 (9GB)\nAPI: Google Gemini 1.5 Pro\n数据库: SQLite (轻量缓存)\n向量搜索: Qdrant Lite (本地)\n部署: Docker + (可选) GCP Cloud Run","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"编程语言: Go 1.21+\n本地推理引擎: llama.cpp\n模型: Yi-6B-Chat GGUF INT8 (9GB)\nAPI: Google Gemini 1.5 Pro\n数据库: SQLite (轻量缓存)\n向量搜索: Qdrant Lite (本地)\n部署: Docker + (可选) GCP Cloud Run","href":null}],"language":"yaml"}},{"object":"block","id":"b8ccb330-a5ab-46ea-85b5-fbd9abd48810","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"依赖库","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"依赖库","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"04da7314-297b-481b-b1ef-6e9086097066","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// Go dependencies\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// Go dependencies\n","href":null},{"type":"text","text":{"content":"github.com/go-skynet/go-llama.cpp","link":{"url":"http://github.com/go-skynet/go-llama.cpp"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/go-skynet/go-llama.cpp","href":"http://github.com/go-skynet/go-llama.cpp"},{"type":"text","text":{"content":"  // llama.cpp Go 绑定\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"  // llama.cpp Go 绑定\n","href":null},{"type":"text","text":{"content":"github.com/google/generative-ai-go","link":{"url":"http://github.com/google/generative-ai-go"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/google/generative-ai-go","href":"http://github.com/google/generative-ai-go"},{"type":"text","text":{"content":" // Gemini API\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" // Gemini API\n","href":null},{"type":"text","text":{"content":"github.com/mattn/go-sqlite3","link":{"url":"http://github.com/mattn/go-sqlite3"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/mattn/go-sqlite3","href":"http://github.com/mattn/go-sqlite3"},{"type":"text","text":{"content":"         // SQLite\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"         // SQLite\n","href":null},{"type":"text","text":{"content":"github.com/qdrant/go-client","link":{"url":"http://github.com/qdrant/go-client"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/qdrant/go-client","href":"http://github.com/qdrant/go-client"},{"type":"text","text":{"content":"         // Qdrant\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"         // Qdrant\n","href":null},{"type":"text","text":{"content":"github.com/gin-gonic/gin","link":{"url":"http://github.com/gin-gonic/gin"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/gin-gonic/gin","href":"http://github.com/gin-gonic/gin"},{"type":"text","text":{"content":"            // HTTP Server","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"            // HTTP Server","href":null}],"language":"go"}},{"object":"block","id":"37001c25-c9bc-4744-a0f9-bda7f3418a81","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"2b5ceae0-d8b1-491b-b021-c388a9bf6ba6","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"系统架构","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"系统架构","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"25c945a8-0161-4cc8-ac42-9c95981e0839","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"1. 目录结构","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1. 目录结构","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"54d4c574-69ce-4dfb-9d87-26c383769977","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"zhuge-legion/\n├── cmd/\n│   └── server/\n│       └── main.go              # 主入口\n├── internal/\n│   ├── agents/\n│   │   ├── agent.go             # Agent 接口定义\n│   │   ├── local_agent.go       # 本地模型 Agent (Key 1-4)\n│   │   └── gemini_agent.go      # Gemini Agent (Key 5)\n│   ├── legion/\n│   │   ├── legion.go            # 军团协调器\n│   │   └── strategy.go          # 决策策略\n│   ├── cache/\n│   │   ├── vector_cache.go      # 向量缓存\n│   │   └── result_cache.go      # 结果缓存\n│   └── config/\n│       └── config.go            # 配置管理\n├── models/\n│   └── yi-6b-chat-q8_0.gguf     # 模型文件 (需下载)\n├── configs/\n│   └── prompts.yaml             # Prompt 模板\n├── docker/\n│   ├── Dockerfile\n│   └── docker-compose.yml\n├── scripts/\n│   ├── download_","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"zhuge-legion/\n├── cmd/\n│   └── server/\n│       └── main.go              # 主入口\n├── internal/\n│   ├── agents/\n│   │   ├── agent.go             # Agent 接口定义\n│   │   ├── local_agent.go       # 本地模型 Agent (Key 1-4)\n│   │   └── gemini_agent.go      # Gemini Agent (Key 5)\n│   ├── legion/\n│   │   ├── legion.go            # 军团协调器\n│   │   └── strategy.go          # 决策策略\n│   ├── cache/\n│   │   ├── vector_cache.go      # 向量缓存\n│   │   └── result_cache.go      # 结果缓存\n│   └── config/\n│       └── config.go            # 配置管理\n├── models/\n│   └── yi-6b-chat-q8_0.gguf     # 模型文件 (需下载)\n├── configs/\n│   └── prompts.yaml             # Prompt 模板\n├── docker/\n│   ├── Dockerfile\n│   └── docker-compose.yml\n├── scripts/\n│   ├── download_","href":null},{"type":"text","text":{"content":"model.sh","link":{"url":"http://model.sh/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"model.sh","href":"http://model.sh/"},{"type":"text","text":{"content":"        # 下载模型\n│   └── deploy_","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"        # 下载模型\n│   └── deploy_","href":null},{"type":"text","text":{"content":"gcp.sh","link":{"url":"http://gcp.sh/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"gcp.sh","href":"http://gcp.sh/"},{"type":"text","text":{"content":"            # GCP 部署\n├── go.mod\n└── ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"            # GCP 部署\n├── go.mod\n└── ","href":null},{"type":"text","text":{"content":"README.md","link":{"url":"http://readme.md/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"README.md","href":"http://readme.md/"}],"language":"javascript"}},{"object":"block","id":"4b858098-7fb7-4efb-b5bd-bd525fc0b1ca","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"f15b8a30-0877-4b1e-a41f-6fb3f2914839","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"核心组件设计","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"核心组件设计","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"65c86beb-9ae5-46f8-8864-6586234535a0","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"组件 1: Agent 接口","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"组件 1: Agent 接口","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f911d4dd-93e3-4845-a059-55ebb137eedb","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"internal/agents/agent.go","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"internal/agents/agent.go","href":null}],"color":"default"}},{"object":"block","id":"d22f2c3b-02fd-47f5-9f30-4a29991ac1a4","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package agents\n\nimport \"context\"\n\n// AgentRole 定义 Agent 角色\ntype AgentRole string\n\nconst (\n    RoleArchitect AgentRole = \"architect\" // 理想方案生成器\n    RoleAdversary AgentRole = \"adversary\" // 红队攻击者\n    RoleRealist   AgentRole = \"realist\"   // 现实约束评估\n    RoleChaos     AgentRole = \"chaos\"     // 盲盒变异器\n    RoleArbiter   AgentRole = \"arbiter\"   // 纳什均衡仲裁\n)\n\n// Agent 接口定义\ntype Agent interface {\n    // Generate 生成响应\n    Generate(ctx context.Context, prompt string) (string, error)\n    \n    // GetRole 获取角色\n    GetRole() AgentRole\n    \n    // GetTemperature 获取温度参数\n    GetTemperature() float32\n    \n    // Close 释放资源\n    Close() error\n}\n\n// GenerateRequest 生成请求\ntype GenerateRequest struct {\n    Mission     string            // 用户任务\n    Context     map[string]string // 上下文信息\n    MaxTokens   int               // 最大 token 数\n    Temperature float32           // 温度参数\n}\n\n// GenerateResponse 生成响应\ntype GenerateResponse struct {\n    Role      AgentRole // 角色\n    Content   string    // 生成内容\n    Tokens    int       // 消耗 token 数\n    Duration  int64     // 耗时（毫秒）\n    Cached    bool      // 是否命中缓存\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package agents\n\nimport \"context\"\n\n// AgentRole 定义 Agent 角色\ntype AgentRole string\n\nconst (\n    RoleArchitect AgentRole = \"architect\" // 理想方案生成器\n    RoleAdversary AgentRole = \"adversary\" // 红队攻击者\n    RoleRealist   AgentRole = \"realist\"   // 现实约束评估\n    RoleChaos     AgentRole = \"chaos\"     // 盲盒变异器\n    RoleArbiter   AgentRole = \"arbiter\"   // 纳什均衡仲裁\n)\n\n// Agent 接口定义\ntype Agent interface {\n    // Generate 生成响应\n    Generate(ctx context.Context, prompt string) (string, error)\n    \n    // GetRole 获取角色\n    GetRole() AgentRole\n    \n    // GetTemperature 获取温度参数\n    GetTemperature() float32\n    \n    // Close 释放资源\n    Close() error\n}\n\n// GenerateRequest 生成请求\ntype GenerateRequest struct {\n    Mission     string            // 用户任务\n    Context     map[string]string // 上下文信息\n    MaxTokens   int               // 最大 token 数\n    Temperature float32           // 温度参数\n}\n\n// GenerateResponse 生成响应\ntype GenerateResponse struct {\n    Role      AgentRole // 角色\n    Content   string    // 生成内容\n    Tokens    int       // 消耗 token 数\n    Duration  int64     // 耗时（毫秒）\n    Cached    bool      // 是否命中缓存\n}","href":null}],"language":"go"}},{"object":"block","id":"51c8ff5d-d37d-4cd2-8d83-97cdc16bce75","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"2c21efb0-82f9-4f3c-a279-29d6fac6e011","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"组件 2: 本地模型 Agent","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"组件 2: 本地模型 Agent","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"75fe31ea-7c5e-483c-ac43-2cd7b2fb6079","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"internal/agents/local_agent.go","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"internal/agents/local_agent.go","href":null}],"color":"default"}},{"object":"block","id":"1e588eb0-81cc-4ee2-83b5-9fd501e790e0","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package agents\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n    \n    llama \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package agents\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n    \n    llama \"","href":null},{"type":"text","text":{"content":"github.com/go-skynet/go-llama.cpp","link":{"url":"http://github.com/go-skynet/go-llama.cpp"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/go-skynet/go-llama.cpp","href":"http://github.com/go-skynet/go-llama.cpp"},{"type":"text","text":{"content":"\"\n)\n\n// LocalAgent 本地模型 Agent\ntype LocalAgent struct {\n    role        AgentRole\n    model       *llama.LLama\n    temperature float32\n    systemPrompt string\n}\n\n// NewLocalAgent 创建本地 Agent\nfunc NewLocalAgent(\n    role AgentRole,\n    modelPath string,\n    systemPrompt string,\n    temperature float32,\n) (*LocalAgent, error) {\n    // 加载模型\n    model, err := ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n)\n\n// LocalAgent 本地模型 Agent\ntype LocalAgent struct {\n    role        AgentRole\n    model       *llama.LLama\n    temperature float32\n    systemPrompt string\n}\n\n// NewLocalAgent 创建本地 Agent\nfunc NewLocalAgent(\n    role AgentRole,\n    modelPath string,\n    systemPrompt string,\n    temperature float32,\n) (*LocalAgent, error) {\n    // 加载模型\n    model, err := ","href":null},{"type":"text","text":{"content":"llama.New","link":{"url":"http://llama.new/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"llama.New","href":"http://llama.new/"},{"type":"text","text":{"content":"(\n        modelPath,\n        llama.SetContext(4096),\n        llama.SetGPULayers(0), // CPU 推理\n        llama.SetThreads(4),\n    )\n    if err != nil {\n        return nil, fmt.Errorf(\"load model: %w\", err)\n    }\n    \n    return &LocalAgent{\n        role:        role,\n        model:       model,\n        temperature: temperature,\n        systemPrompt: systemPrompt,\n    }, nil\n}\n\n// Generate 生成响应\nfunc (a *LocalAgent) Generate(ctx context.Context, prompt string) (string, error) {\n    start := ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\n        modelPath,\n        llama.SetContext(4096),\n        llama.SetGPULayers(0), // CPU 推理\n        llama.SetThreads(4),\n    )\n    if err != nil {\n        return nil, fmt.Errorf(\"load model: %w\", err)\n    }\n    \n    return &LocalAgent{\n        role:        role,\n        model:       model,\n        temperature: temperature,\n        systemPrompt: systemPrompt,\n    }, nil\n}\n\n// Generate 生成响应\nfunc (a *LocalAgent) Generate(ctx context.Context, prompt string) (string, error) {\n    start := ","href":null},{"type":"text","text":{"content":"time.Now","link":{"url":"http://time.now/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"time.Now","href":"http://time.now/"},{"type":"text","text":{"content":"()\n    \n    // 构建完整 prompt\n    fullPrompt := fmt.Sprintf(\n        \"System: %s\\n\\nUser: %s\\n\\nAssistant:\",\n        a.systemPrompt,\n        prompt,\n    )\n    \n    // 生成\n    result, err := a.model.Predict(\n        fullPrompt,\n        llama.SetTokens(512),\n        llama.SetTemperature(a.temperature),\n        llama.SetTopP(0.95),\n        llama.SetStopWords(\"User:\", \"System:\"),\n    )\n    \n    if err != nil {\n        return \"\", fmt.Errorf(\"generate: %w\", err)\n    }\n    \n    duration := time.Since(start).Milliseconds()\n    fmt.Printf(\"[%s] Generated in %dms\\n\", a.role, duration)\n    \n    return result, nil\n}\n\nfunc (a *LocalAgent) GetRole() AgentRole {\n    return a.role\n}\n\nfunc (a *LocalAgent) GetTemperature() float32 {\n    return a.temperature\n}\n\nfunc (a *LocalAgent) Close() error {\n    ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"()\n    \n    // 构建完整 prompt\n    fullPrompt := fmt.Sprintf(\n        \"System: %s\\n\\nUser: %s\\n\\nAssistant:\",\n        a.systemPrompt,\n        prompt,\n    )\n    \n    // 生成\n    result, err := a.model.Predict(\n        fullPrompt,\n        llama.SetTokens(512),\n        llama.SetTemperature(a.temperature),\n        llama.SetTopP(0.95),\n        llama.SetStopWords(\"User:\", \"System:\"),\n    )\n    \n    if err != nil {\n        return \"\", fmt.Errorf(\"generate: %w\", err)\n    }\n    \n    duration := time.Since(start).Milliseconds()\n    fmt.Printf(\"[%s] Generated in %dms\\n\", a.role, duration)\n    \n    return result, nil\n}\n\nfunc (a *LocalAgent) GetRole() AgentRole {\n    return a.role\n}\n\nfunc (a *LocalAgent) GetTemperature() float32 {\n    return a.temperature\n}\n\nfunc (a *LocalAgent) Close() error {\n    ","href":null},{"type":"text","text":{"content":"a.model.Free","link":{"url":"http://a.model.free/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"a.model.Free","href":"http://a.model.free/"},{"type":"text","text":{"content":"()\n    return nil\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"()\n    return nil\n}","href":null}],"language":"go"}},{"object":"block","id":"401a1140-d004-4fc0-b31c-d7912cdeee23","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"14cd9147-eed7-420f-8538-fe469c73a787","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"组件 3: Gemini Agent","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"组件 3: Gemini Agent","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"3b5c88a6-071d-4dfc-ad06-500eac775e3d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"internal/agents/gemini_agent.go","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"internal/agents/gemini_agent.go","href":null}],"color":"default"}},{"object":"block","id":"c37f8283-3d51-43fd-a43a-10a002d01832","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package agents\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n    \n    \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package agents\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n    \n    \"","href":null},{"type":"text","text":{"content":"github.com/google/generative-ai-go/genai","link":{"url":"http://github.com/google/generative-ai-go/genai"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/google/generative-ai-go/genai","href":"http://github.com/google/generative-ai-go/genai"},{"type":"text","text":{"content":"\"\n    \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n    \"","href":null},{"type":"text","text":{"content":"google.golang.org/api/option","link":{"url":"http://google.golang.org/api/option"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"google.golang.org/api/option","href":"http://google.golang.org/api/option"},{"type":"text","text":{"content":"\"\n)\n\n// GeminiAgent Gemini API Agent\ntype GeminiAgent struct {\n    role        AgentRole\n    client      *genai.Client\n    model       *genai.GenerativeModel\n    systemPrompt string\n}\n\n// NewGeminiAgent 创建 Gemini Agent\nfunc NewGeminiAgent(\n    ctx context.Context,\n    apiKey string,\n    systemPrompt string,\n) (*GeminiAgent, error) {\n    client, err := genai.NewClient(ctx, option.WithAPIKey(apiKey))\n    if err != nil {\n        return nil, fmt.Errorf(\"create client: %w\", err)\n    }\n    \n    model := client.GenerativeModel(\"gemini-1.5-pro\")\n    model.SetTemperature(0.7)\n    model.SetTopP(0.95)\n    model.SetMaxOutputTokens(2048)\n    model.SystemInstruction = &genai.Content{\n        Parts: []genai.Part{genai.Text(systemPrompt)},\n    }\n    \n    return &GeminiAgent{\n        role:        RoleArbiter,\n        client:      client,\n        model:       model,\n        systemPrompt: systemPrompt,\n    }, nil\n}\n\n// Generate 生成响应\nfunc (a *GeminiAgent) Generate(ctx context.Context, prompt string) (string, error) {\n    start := ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n)\n\n// GeminiAgent Gemini API Agent\ntype GeminiAgent struct {\n    role        AgentRole\n    client      *genai.Client\n    model       *genai.GenerativeModel\n    systemPrompt string\n}\n\n// NewGeminiAgent 创建 Gemini Agent\nfunc NewGeminiAgent(\n    ctx context.Context,\n    apiKey string,\n    systemPrompt string,\n) (*GeminiAgent, error) {\n    client, err := genai.NewClient(ctx, option.WithAPIKey(apiKey))\n    if err != nil {\n        return nil, fmt.Errorf(\"create client: %w\", err)\n    }\n    \n    model := client.GenerativeModel(\"gemini-1.5-pro\")\n    model.SetTemperature(0.7)\n    model.SetTopP(0.95)\n    model.SetMaxOutputTokens(2048)\n    model.SystemInstruction = &genai.Content{\n        Parts: []genai.Part{genai.Text(systemPrompt)},\n    }\n    \n    return &GeminiAgent{\n        role:        RoleArbiter,\n        client:      client,\n        model:       model,\n        systemPrompt: systemPrompt,\n    }, nil\n}\n\n// Generate 生成响应\nfunc (a *GeminiAgent) Generate(ctx context.Context, prompt string) (string, error) {\n    start := ","href":null},{"type":"text","text":{"content":"time.Now","link":{"url":"http://time.now/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"time.Now","href":"http://time.now/"},{"type":"text","text":{"content":"()\n    \n    resp, err := a.model.GenerateContent(ctx, genai.Text(prompt))\n    if err != nil {\n        return \"\", fmt.Errorf(\"generate: %w\", err)\n    }\n    \n    if len(resp.Candidates) == 0 {\n        return \"\", fmt.Errorf(\"no candidates\")\n    }\n    \n    // 提取文本\n    var result string\n    for _, part := range resp.Candidates[0].","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"()\n    \n    resp, err := a.model.GenerateContent(ctx, genai.Text(prompt))\n    if err != nil {\n        return \"\", fmt.Errorf(\"generate: %w\", err)\n    }\n    \n    if len(resp.Candidates) == 0 {\n        return \"\", fmt.Errorf(\"no candidates\")\n    }\n    \n    // 提取文本\n    var result string\n    for _, part := range resp.Candidates[0].","href":null},{"type":"text","text":{"content":"Content.Parts","link":{"url":"http://content.parts/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Content.Parts","href":"http://content.parts/"},{"type":"text","text":{"content":" {\n        if text, ok := part.(genai.Text); ok {\n            result += string(text)\n        }\n    }\n    \n    duration := time.Since(start).Milliseconds()\n    fmt.Printf(\"[%s] Generated in %dms\\n\", a.role, duration)\n    \n    return result, nil\n}\n\nfunc (a *GeminiAgent) GetRole() AgentRole {\n    return a.role\n}\n\nfunc (a *GeminiAgent) GetTemperature() float32 {\n    return 0.7\n}\n\nfunc (a *GeminiAgent) Close() error {\n    return a.client.Close()\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" {\n        if text, ok := part.(genai.Text); ok {\n            result += string(text)\n        }\n    }\n    \n    duration := time.Since(start).Milliseconds()\n    fmt.Printf(\"[%s] Generated in %dms\\n\", a.role, duration)\n    \n    return result, nil\n}\n\nfunc (a *GeminiAgent) GetRole() AgentRole {\n    return a.role\n}\n\nfunc (a *GeminiAgent) GetTemperature() float32 {\n    return 0.7\n}\n\nfunc (a *GeminiAgent) Close() error {\n    return a.client.Close()\n}","href":null}],"language":"go"}},{"object":"block","id":"546d1e08-a546-4af7-8af5-63766e67b171","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"9470e526-3c6d-4228-b96f-974eede12238","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"组件 4: 军团协调器","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"组件 4: 军团协调器","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"47683af4-38d9-4079-8b13-1af850ad8081","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"internal/legion/legion.go","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"internal/legion/legion.go","href":null}],"color":"default"}},{"object":"block","id":"614b5fbb-aa1c-4751-a9da-c201e266f933","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package legion\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"sync\"\n    \"time\"\n    \n    \"zhuge-legion/internal/agents\"\n    \"zhuge-legion/internal/cache\"\n)\n\n// Legion 诸葛亮军团\ntype Legion struct {\n    agents      map[agents.AgentRole]agents.Agent\n    cache       *cache.VectorCache\n    resultCache *cache.ResultCache\n}\n\n// NewLegion 创建军团\nfunc NewLegion(\n    agentList []agents.Agent,\n    vectorCache *cache.VectorCache,\n    resultCache *cache.ResultCache,\n) *Legion {\n    agentMap := make(map[agents.AgentRole]agents.Agent)\n    for _, agent := range agentList {\n        agentMap[agent.GetRole()] = agent\n    }\n    \n    return &Legion{\n        agents:      agentMap,\n        cache:       vectorCache,\n        resultCache: resultCache,\n    }\n}\n\n// Deploy 部署任务\nfunc (l *Legion) Deploy(ctx context.Context, mission string) (*Decision, error) {\n    // 1. 检查缓存\n    if cached, ok := l.checkCache(mission); ok {\n        fmt.Println(\"✓ Cache hit\")\n        return cached, nil\n    }\n    \n    // 2. 并发执行 Key 1-4\n    timelines := l.executeParallel(ctx, mission)\n    \n    // 3. Key 5 做最终决策\n    decision := l.arbitrate(ctx, mission, timelines)\n    \n    // 4. 存入缓存\n    l.saveCache(mission, decision)\n    \n    return decision, nil\n}\n\n// executeParallel 并发执行 Key 1-4\nfunc (l *Legion) executeParallel(ctx context.Context, mission string) []agents.GenerateResponse {\n    roles := []agents.AgentRole{\n        agents.RoleArchitect,\n        agents.RoleAdversary,\n        agents.RoleRealist,\n        agents.RoleChaos,\n    }\n    \n    var wg sync.WaitGroup\n    timelineChan := make(chan agents.GenerateResponse, len(roles))\n    \n    for _, role := range roles {\n        wg.Add(1)\n        go func(r agents.AgentRole) {\n            defer wg.Done()\n            \n            agent := l.agents[r]\n            prompt := l.buildPrompt(r, mission)\n            \n            start := ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package legion\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"sync\"\n    \"time\"\n    \n    \"zhuge-legion/internal/agents\"\n    \"zhuge-legion/internal/cache\"\n)\n\n// Legion 诸葛亮军团\ntype Legion struct {\n    agents      map[agents.AgentRole]agents.Agent\n    cache       *cache.VectorCache\n    resultCache *cache.ResultCache\n}\n\n// NewLegion 创建军团\nfunc NewLegion(\n    agentList []agents.Agent,\n    vectorCache *cache.VectorCache,\n    resultCache *cache.ResultCache,\n) *Legion {\n    agentMap := make(map[agents.AgentRole]agents.Agent)\n    for _, agent := range agentList {\n        agentMap[agent.GetRole()] = agent\n    }\n    \n    return &Legion{\n        agents:      agentMap,\n        cache:       vectorCache,\n        resultCache: resultCache,\n    }\n}\n\n// Deploy 部署任务\nfunc (l *Legion) Deploy(ctx context.Context, mission string) (*Decision, error) {\n    // 1. 检查缓存\n    if cached, ok := l.checkCache(mission); ok {\n        fmt.Println(\"✓ Cache hit\")\n        return cached, nil\n    }\n    \n    // 2. 并发执行 Key 1-4\n    timelines := l.executeParallel(ctx, mission)\n    \n    // 3. Key 5 做最终决策\n    decision := l.arbitrate(ctx, mission, timelines)\n    \n    // 4. 存入缓存\n    l.saveCache(mission, decision)\n    \n    return decision, nil\n}\n\n// executeParallel 并发执行 Key 1-4\nfunc (l *Legion) executeParallel(ctx context.Context, mission string) []agents.GenerateResponse {\n    roles := []agents.AgentRole{\n        agents.RoleArchitect,\n        agents.RoleAdversary,\n        agents.RoleRealist,\n        agents.RoleChaos,\n    }\n    \n    var wg sync.WaitGroup\n    timelineChan := make(chan agents.GenerateResponse, len(roles))\n    \n    for _, role := range roles {\n        wg.Add(1)\n        go func(r agents.AgentRole) {\n            defer wg.Done()\n            \n            agent := l.agents[r]\n            prompt := l.buildPrompt(r, mission)\n            \n            start := ","href":null},{"type":"text","text":{"content":"time.Now","link":{"url":"http://time.now/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"time.Now","href":"http://time.now/"},{"type":"text","text":{"content":"()\n            content, err := agent.Generate(ctx, prompt)\n            if err != nil {\n                fmt.Printf(\"[%s] Error: %v\\n\", r, err)\n                return\n            }\n            \n            timelineChan <- agents.GenerateResponse{\n                Role:     r,\n                Content:  content,\n                Duration: time.Since(start).Milliseconds(),\n            }\n        }(role)\n    }\n    \n    wg.Wait()\n    close(timelineChan)\n    \n    // 收集结果\n    var timelines []agents.GenerateResponse\n    for t := range timelineChan {\n        timelines = append(timelines, t)\n    }\n    \n    return timelines\n}\n\n// arbitrate Key 5 仲裁\nfunc (l *Legion) arbitrate(\n    ctx context.Context,\n    mission string,\n    timelines []agents.GenerateResponse,\n) *Decision {\n    arbiter := l.agents[agents.RoleArbiter]\n    \n    // 构建综合 prompt\n    prompt := fmt.Sprintf(`任务: %s\n\n已收到4个不同维度的分析：\n\n`, mission)\n    \n    for _, t := range timelines {\n        prompt += fmt.Sprintf(\"[%s 维度]\\n%s\\n\\n\", t.Role, t.Content)\n    }\n    \n    prompt += `请作为最终仲裁者，综合以上分析，给出纳什均衡解决方案。\n要求：\n1. 指出各方案的优劣\n2. 给出综合建议\n3. 标注风险点`\n    \n    content, err := arbiter.Generate(ctx, prompt)\n    if err != nil {\n        fmt.Printf(\"Arbiter error: %v\\n\", err)\n        return nil\n    }\n    \n    return &Decision{\n        Mission:   mission,\n        Timelines: timelines,\n        Final:     content,\n        Timestamp: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"()\n            content, err := agent.Generate(ctx, prompt)\n            if err != nil {\n                fmt.Printf(\"[%s] Error: %v\\n\", r, err)\n                return\n            }\n            \n            timelineChan <- agents.GenerateResponse{\n                Role:     r,\n                Content:  content,\n                Duration: time.Since(start).Milliseconds(),\n            }\n        }(role)\n    }\n    \n    wg.Wait()\n    close(timelineChan)\n    \n    // 收集结果\n    var timelines []agents.GenerateResponse\n    for t := range timelineChan {\n        timelines = append(timelines, t)\n    }\n    \n    return timelines\n}\n\n// arbitrate Key 5 仲裁\nfunc (l *Legion) arbitrate(\n    ctx context.Context,\n    mission string,\n    timelines []agents.GenerateResponse,\n) *Decision {\n    arbiter := l.agents[agents.RoleArbiter]\n    \n    // 构建综合 prompt\n    prompt := fmt.Sprintf(`任务: %s\n\n已收到4个不同维度的分析：\n\n`, mission)\n    \n    for _, t := range timelines {\n        prompt += fmt.Sprintf(\"[%s 维度]\\n%s\\n\\n\", t.Role, t.Content)\n    }\n    \n    prompt += `请作为最终仲裁者，综合以上分析，给出纳什均衡解决方案。\n要求：\n1. 指出各方案的优劣\n2. 给出综合建议\n3. 标注风险点`\n    \n    content, err := arbiter.Generate(ctx, prompt)\n    if err != nil {\n        fmt.Printf(\"Arbiter error: %v\\n\", err)\n        return nil\n    }\n    \n    return &Decision{\n        Mission:   mission,\n        Timelines: timelines,\n        Final:     content,\n        Timestamp: ","href":null},{"type":"text","text":{"content":"time.Now","link":{"url":"http://time.now/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"time.Now","href":"http://time.now/"},{"type":"text","text":{"content":"(),\n    }\n}\n\n// buildPrompt 构建角色专属 prompt\nfunc (l *Legion) buildPrompt(role agents.AgentRole, mission string) string {\n    templates := map[agents.AgentRole]string{\n        agents.RoleArchitect: \"作为理想方案设计师，在无限资源、无摩擦的情况下，为以下任务设计最优解决方案：%s\",\n        agents.RoleAdversary: \"作为红队攻击者，找出以下任务可能遇到的所有风险、漏洞和失败点：%s\",\n        agents.RoleRealist:   \"作为现实约束评估者，考虑成本、法律、物理限制，评估任务的可行性：%s\",\n        agents.RoleChaos:     \"作为非常规方案生成器，提出违反直觉但可能有效的解决思路（必须合法可行）：%s\",\n    }\n    \n    return fmt.Sprintf(templates[role], mission)\n}\n\n// checkCache 检查缓存\nfunc (l *Legion) checkCache(mission string) (*Decision, bool) {\n    return l.resultCache.Get(mission)\n}\n\n// saveCache 保存缓存\nfunc (l *Legion) saveCache(mission string, decision *Decision) {\n    l.resultCache.Set(mission, decision)\n}\n\n// Decision 决策结果\ntype Decision struct {\n    Mission   string\n    Timelines []agents.GenerateResponse\n    Final     string\n    Timestamp time.Time\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(),\n    }\n}\n\n// buildPrompt 构建角色专属 prompt\nfunc (l *Legion) buildPrompt(role agents.AgentRole, mission string) string {\n    templates := map[agents.AgentRole]string{\n        agents.RoleArchitect: \"作为理想方案设计师，在无限资源、无摩擦的情况下，为以下任务设计最优解决方案：%s\",\n        agents.RoleAdversary: \"作为红队攻击者，找出以下任务可能遇到的所有风险、漏洞和失败点：%s\",\n        agents.RoleRealist:   \"作为现实约束评估者，考虑成本、法律、物理限制，评估任务的可行性：%s\",\n        agents.RoleChaos:     \"作为非常规方案生成器，提出违反直觉但可能有效的解决思路（必须合法可行）：%s\",\n    }\n    \n    return fmt.Sprintf(templates[role], mission)\n}\n\n// checkCache 检查缓存\nfunc (l *Legion) checkCache(mission string) (*Decision, bool) {\n    return l.resultCache.Get(mission)\n}\n\n// saveCache 保存缓存\nfunc (l *Legion) saveCache(mission string, decision *Decision) {\n    l.resultCache.Set(mission, decision)\n}\n\n// Decision 决策结果\ntype Decision struct {\n    Mission   string\n    Timelines []agents.GenerateResponse\n    Final     string\n    Timestamp time.Time\n}","href":null}],"language":"go"}},{"object":"block","id":"76ce7214-649e-4868-ae16-4e9921102d5d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"6c870f77-3680-4ffd-a67b-a29c1f9fef83","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"System Prompts 配置","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"System Prompts 配置","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"87b2d016-11eb-43c1-982f-7d776dfac89c","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"configs/prompts.yaml","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"configs/prompts.yaml","href":null}],"color":"default"}},{"object":"block","id":"ce458c83-4c67-4940-9d18-5c8aadcf6fd7","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"agents:\n  architect:\n    system_prompt: |\n      你是一个理想化方案设计师。你的任务是在无限资源、零摩擦的假设下，\n      设计出技术上最优的解决方案。不考虑成本、时间、人力限制。\n      \n      输出格式：\n      1. 核心方案概述\n      2. 技术架构设计\n      3. 预期效果\n      4. 所需资源（理想状态）\n    temperature: 0.7\n    \n  adversary:\n    system_prompt: |\n      你是一个专业的红队攻击者和风险评估专家。你的任务是找出方案中的\n      所有漏洞、风险点、潜在失败模式。\n      \n      分析维度：\n      1. 技术风险（漏洞、性能瓶颈）\n      2. 人为风险（操作失误、恶意行为）\n      3. 外部风险（黑天鹅事件、竞争对手）\n      4. 边缘案例（极端情况下的表现）\n    temperature: 0.8\n    \n  realist:\n    system_prompt: |\n      你是一个务实的项目评估专家。你的任务是在现实约束下评估方案的\n      可行性和成本。\n      \n      考虑因素：\n      1. 预算限制\n      2. 时间限制\n      3. 人力资源\n      4. 法律合规\n      5. 技术债务\n    temperature: 0.7\n    \n  chaos:\n    system_prompt: |\n      你是一个非常规方案生成器。你的任务是提出违反直觉但可能有效的\n      解决思路。\n      \n      要求：\n      1. 必须合法且物理上可行\n      2. 可以挑战常规最佳实践\n      3. 关注被忽视的角度\n      4. 提出创新性组合\n      \n      禁止：纯粹的随机噪音、不可行的幻想\n    temperature: 1.5\n    \n  arbiter:\n    system_prompt: |\n      你是最终仲裁者，负责综合多维度分析，找出纳什均衡解决方案。\n      \n      职责：\n      1. 评估各方案的优劣\n      2. 识别矛盾点\n      3. 寻找平衡点（各方都无法通过单方面改变策略而获益）\n      4. 给出可执行的综合建议\n      5. 标注关键风险\n    temperature: 0.7","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"agents:\n  architect:\n    system_prompt: |\n      你是一个理想化方案设计师。你的任务是在无限资源、零摩擦的假设下，\n      设计出技术上最优的解决方案。不考虑成本、时间、人力限制。\n      \n      输出格式：\n      1. 核心方案概述\n      2. 技术架构设计\n      3. 预期效果\n      4. 所需资源（理想状态）\n    temperature: 0.7\n    \n  adversary:\n    system_prompt: |\n      你是一个专业的红队攻击者和风险评估专家。你的任务是找出方案中的\n      所有漏洞、风险点、潜在失败模式。\n      \n      分析维度：\n      1. 技术风险（漏洞、性能瓶颈）\n      2. 人为风险（操作失误、恶意行为）\n      3. 外部风险（黑天鹅事件、竞争对手）\n      4. 边缘案例（极端情况下的表现）\n    temperature: 0.8\n    \n  realist:\n    system_prompt: |\n      你是一个务实的项目评估专家。你的任务是在现实约束下评估方案的\n      可行性和成本。\n      \n      考虑因素：\n      1. 预算限制\n      2. 时间限制\n      3. 人力资源\n      4. 法律合规\n      5. 技术债务\n    temperature: 0.7\n    \n  chaos:\n    system_prompt: |\n      你是一个非常规方案生成器。你的任务是提出违反直觉但可能有效的\n      解决思路。\n      \n      要求：\n      1. 必须合法且物理上可行\n      2. 可以挑战常规最佳实践\n      3. 关注被忽视的角度\n      4. 提出创新性组合\n      \n      禁止：纯粹的随机噪音、不可行的幻想\n    temperature: 1.5\n    \n  arbiter:\n    system_prompt: |\n      你是最终仲裁者，负责综合多维度分析，找出纳什均衡解决方案。\n      \n      职责：\n      1. 评估各方案的优劣\n      2. 识别矛盾点\n      3. 寻找平衡点（各方都无法通过单方面改变策略而获益）\n      4. 给出可执行的综合建议\n      5. 标注关键风险\n    temperature: 0.7","href":null}],"language":"yaml"}},{"object":"block","id":"36bded84-2ac4-4a6f-8823-845d3c92c898","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"584409a9-3e67-4132-9f83-1a6dd4b35601","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"主程序入口","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"主程序入口","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ccb4e6f2-3a2d-4ac9-bc64-c55d8d3fad66","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"文件","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"文件","href":null},{"type":"text","text":{"content":": ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":": ","href":null},{"type":"text","text":{"content":"cmd/server/main.go","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"cmd/server/main.go","href":null}],"color":"default"}},{"object":"block","id":"18eb0dac-b8ab-4c87-8954-fb9f4eadf53d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \n    \"zhuge-legion/internal/agents\"\n    \"zhuge-legion/internal/cache\"\n    \"zhuge-legion/internal/legion\"\n    \n    \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \n    \"zhuge-legion/internal/agents\"\n    \"zhuge-legion/internal/cache\"\n    \"zhuge-legion/internal/legion\"\n    \n    \"","href":null},{"type":"text","text":{"content":"github.com/gin-gonic/gin","link":{"url":"http://github.com/gin-gonic/gin"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/gin-gonic/gin","href":"http://github.com/gin-gonic/gin"},{"type":"text","text":{"content":"\"\n)\n\nfunc main() {\n    ctx := context.Background()\n    \n    // 1. 加载配置\n    modelPath := \"./models/yi-6b-chat-q8_0.gguf\"\n    geminiKey := os.Getenv(\"GEMINI_API_KEY\")\n    \n    // 2. 创建 Agents\n    agentList := make([]agents.Agent, 0)\n    \n    // Key 1: Architect\n    architect, err := agents.NewLocalAgent(\n        agents.RoleArchitect,\n        modelPath,\n        loadPrompt(\"architect\"),\n        0.7,\n    )\n    if err != nil {\n        log.Fatalf(\"Create architect: %v\", err)\n    }\n    agentList = append(agentList, architect)\n    \n    // Key 2: Adversary\n    adversary, err := agents.NewLocalAgent(\n        agents.RoleAdversary,\n        modelPath,\n        loadPrompt(\"adversary\"),\n        0.8,\n    )\n    if err != nil {\n        log.Fatalf(\"Create adversary: %v\", err)\n    }\n    agentList = append(agentList, adversary)\n    \n    // Key 3: Realist\n    realist, err := agents.NewLocalAgent(\n        agents.RoleRealist,\n        modelPath,\n        loadPrompt(\"realist\"),\n        0.7,\n    )\n    if err != nil {\n        log.Fatalf(\"Create realist: %v\", err)\n    }\n    agentList = append(agentList, realist)\n    \n    // Key 4: Chaos\n    chaos, err := agents.NewLocalAgent(\n        agents.RoleChaos,\n        modelPath,\n        loadPrompt(\"chaos\"),\n        1.5,\n    )\n    if err != nil {\n        log.Fatalf(\"Create chaos: %v\", err)\n    }\n    agentList = append(agentList, chaos)\n    \n    // Key 5: Arbiter (Gemini)\n    arbiter, err := agents.NewGeminiAgent(\n        ctx,\n        geminiKey,\n        loadPrompt(\"arbiter\"),\n    )\n    if err != nil {\n        log.Fatalf(\"Create arbiter: %v\", err)\n    }\n    agentList = append(agentList, arbiter)\n    \n    // 3. 创建缓存\n    vectorCache := cache.NewVectorCache()\n    resultCache := cache.NewResultCache()\n    \n    // 4. 创建军团\n    leg := legion.NewLegion(agentList, vectorCache, resultCache)\n    \n    // 5. 启动 HTTP 服务\n    r := gin.Default()\n    \n    ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n)\n\nfunc main() {\n    ctx := context.Background()\n    \n    // 1. 加载配置\n    modelPath := \"./models/yi-6b-chat-q8_0.gguf\"\n    geminiKey := os.Getenv(\"GEMINI_API_KEY\")\n    \n    // 2. 创建 Agents\n    agentList := make([]agents.Agent, 0)\n    \n    // Key 1: Architect\n    architect, err := agents.NewLocalAgent(\n        agents.RoleArchitect,\n        modelPath,\n        loadPrompt(\"architect\"),\n        0.7,\n    )\n    if err != nil {\n        log.Fatalf(\"Create architect: %v\", err)\n    }\n    agentList = append(agentList, architect)\n    \n    // Key 2: Adversary\n    adversary, err := agents.NewLocalAgent(\n        agents.RoleAdversary,\n        modelPath,\n        loadPrompt(\"adversary\"),\n        0.8,\n    )\n    if err != nil {\n        log.Fatalf(\"Create adversary: %v\", err)\n    }\n    agentList = append(agentList, adversary)\n    \n    // Key 3: Realist\n    realist, err := agents.NewLocalAgent(\n        agents.RoleRealist,\n        modelPath,\n        loadPrompt(\"realist\"),\n        0.7,\n    )\n    if err != nil {\n        log.Fatalf(\"Create realist: %v\", err)\n    }\n    agentList = append(agentList, realist)\n    \n    // Key 4: Chaos\n    chaos, err := agents.NewLocalAgent(\n        agents.RoleChaos,\n        modelPath,\n        loadPrompt(\"chaos\"),\n        1.5,\n    )\n    if err != nil {\n        log.Fatalf(\"Create chaos: %v\", err)\n    }\n    agentList = append(agentList, chaos)\n    \n    // Key 5: Arbiter (Gemini)\n    arbiter, err := agents.NewGeminiAgent(\n        ctx,\n        geminiKey,\n        loadPrompt(\"arbiter\"),\n    )\n    if err != nil {\n        log.Fatalf(\"Create arbiter: %v\", err)\n    }\n    agentList = append(agentList, arbiter)\n    \n    // 3. 创建缓存\n    vectorCache := cache.NewVectorCache()\n    resultCache := cache.NewResultCache()\n    \n    // 4. 创建军团\n    leg := legion.NewLegion(agentList, vectorCache, resultCache)\n    \n    // 5. 启动 HTTP 服务\n    r := gin.Default()\n    \n    ","href":null},{"type":"text","text":{"content":"r.POST","link":{"url":"http://r.post/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"r.POST","href":"http://r.post/"},{"type":"text","text":{"content":"(\"/api/v1/deploy\", func(c *gin.Context) {\n        var req struct {\n            Mission string `json:\"mission\" binding:\"required\"`\n        }\n        \n        if err := c.ShouldBindJSON(&req); err != nil {\n            c.JSON(400, gin.H{\"error\": err.Error()})\n            return\n        }\n        \n        decision, err := leg.Deploy(c.Request.Context(), req.Mission)\n        if err != nil {\n            c.JSON(500, gin.H{\"error\": err.Error()})\n            return\n        }\n        \n        c.JSON(200, decision)\n    })\n    \n    fmt.Println(\"🚀 Zhuge Legion started on :8080\")\n    ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\"/api/v1/deploy\", func(c *gin.Context) {\n        var req struct {\n            Mission string `json:\"mission\" binding:\"required\"`\n        }\n        \n        if err := c.ShouldBindJSON(&req); err != nil {\n            c.JSON(400, gin.H{\"error\": err.Error()})\n            return\n        }\n        \n        decision, err := leg.Deploy(c.Request.Context(), req.Mission)\n        if err != nil {\n            c.JSON(500, gin.H{\"error\": err.Error()})\n            return\n        }\n        \n        c.JSON(200, decision)\n    })\n    \n    fmt.Println(\"🚀 Zhuge Legion started on :8080\")\n    ","href":null},{"type":"text","text":{"content":"r.Run","link":{"url":"http://r.run/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"r.Run","href":"http://r.run/"},{"type":"text","text":{"content":"(\":8080\")\n}\n\nfunc loadPrompt(role string) string {\n    // 从 prompts.yaml 加载\n    // 简化版本，实际应该用 viper 或类似库\n    prompts := map[string]string{\n        \"architect\": \"你是理想方案设计师...\",\n        \"adversary\": \"你是红队攻击者...\",\n        \"realist\":   \"你是务实评估专家...\",\n        \"chaos\":     \"你是非常规方案生成器...\",\n        \"arbiter\":   \"你是最终仲裁者...\",\n    }\n    return prompts[role]\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\":8080\")\n}\n\nfunc loadPrompt(role string) string {\n    // 从 prompts.yaml 加载\n    // 简化版本，实际应该用 viper 或类似库\n    prompts := map[string]string{\n        \"architect\": \"你是理想方案设计师...\",\n        \"adversary\": \"你是红队攻击者...\",\n        \"realist\":   \"你是务实评估专家...\",\n        \"chaos\":     \"你是非常规方案生成器...\",\n        \"arbiter\":   \"你是最终仲裁者...\",\n    }\n    return prompts[role]\n}","href":null}],"language":"go"}},{"object":"block","id":"4a86dfc5-f7b2-471c-91e1-671211106598","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"0e3fb04b-39fa-4274-a4ba-0aa3e58e1e88","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"部署方案","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"部署方案","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"61b35bd6-fdf8-4744-aa81-57f2db50b970","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"方案 A: Mac 本地运行","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"方案 A: Mac 本地运行","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"382708b7-952f-4f7c-84f1-b5194474d938","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"步骤","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"步骤","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ad632f7d-0eb7-4809-85c1-27b4cc3474cf","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 1. 克隆仓库\ngit clone <your-repo>\ncd zhuge-legion\n\n# 2. 下载模型\nbash scripts/download_","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 1. 克隆仓库\ngit clone <your-repo>\ncd zhuge-legion\n\n# 2. 下载模型\nbash scripts/download_","href":null},{"type":"text","text":{"content":"model.sh","link":{"url":"http://model.sh/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"model.sh","href":"http://model.sh/"},{"type":"text","text":{"content":"\n\n# 3. 设置环境变量\nexport GEMINI_API_KEY=\"your-api-key\"\n\n# 4. 编译运行\ngo mod download\ngo run cmd/server/main.go\n\n# 5. 测试\ncurl -X POST ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\n\n# 3. 设置环境变量\nexport GEMINI_API_KEY=\"your-api-key\"\n\n# 4. 编译运行\ngo mod download\ngo run cmd/server/main.go\n\n# 5. 测试\ncurl -X POST ","href":null},{"type":"text","text":{"content":"http://localhost:8080/api/v1/deploy","link":{"url":"http://localhost:8080/api/v1/deploy"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"http://localhost:8080/api/v1/deploy","href":"http://localhost:8080/api/v1/deploy"},{"type":"text","text":{"content":" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"mission\": \"设计一个高并发 API 网关\"}'","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"mission\": \"设计一个高并发 API 网关\"}'","href":null}],"language":"bash"}},{"object":"block","id":"e4d3966d-8629-4dd0-9c5c-dbe40c3ba9d1","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"方案 B: Docker 部署","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"方案 B: Docker 部署","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a79b4f93-5520-43a6-bba7-58169d514e9d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Dockerfile","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Dockerfile","href":null},{"type":"text","text":{"content":":","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":":","href":null}],"color":"default"}},{"object":"block","id":"6937c258-36e7-479a-a28f-0662c2559032","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"FROM golang:1.21-alpine AS builder\n\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\n\nCOPY . .\nRUN go build -o zhuge-legion cmd/server/main.go\n\nFROM alpine:latest\nRUN apk add --no-cache libc6-compat\n\nWORKDIR /app\nCOPY --from=builder /app/zhuge-legion .\nCOPY models/ ./models/\nCOPY configs/ ./configs/\n\nEXPOSE 8080\nCMD [\"./zhuge-legion\"]","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"FROM golang:1.21-alpine AS builder\n\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\n\nCOPY . .\nRUN go build -o zhuge-legion cmd/server/main.go\n\nFROM alpine:latest\nRUN apk add --no-cache libc6-compat\n\nWORKDIR /app\nCOPY --from=builder /app/zhuge-legion .\nCOPY models/ ./models/\nCOPY configs/ ./configs/\n\nEXPOSE 8080\nCMD [\"./zhuge-legion\"]","href":null}],"language":"docker"}},{"object":"block","id":"7d958929-da5b-4a62-ab74-4b20dba07be0","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 构建\ndocker build -t zhuge-legion .\n\n# 运行\ndocker run -p 8080:8080 \\\n  -e GEMINI_API_KEY=\"your-key\" \\\n  -v $(pwd)/models:/app/models \\\n  zhuge-legion","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 构建\ndocker build -t zhuge-legion .\n\n# 运行\ndocker run -p 8080:8080 \\\n  -e GEMINI_API_KEY=\"your-key\" \\\n  -v $(pwd)/models:/app/models \\\n  zhuge-legion","href":null}],"language":"bash"}},{"object":"block","id":"3843a7f5-b271-4254-aa61-bbf4c501e3e3","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"方案 C: GCP Cloud Run 部署","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"方案 C: GCP Cloud Run 部署","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"2a27dde6-bd59-4e36-a893-08bbd2aba261","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 1. 构建并推送镜像\ngcloud builds submit --tag ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 1. 构建并推送镜像\ngcloud builds submit --tag ","href":null},{"type":"text","text":{"content":"gcr.io/PROJECT_ID/zhuge-legion","link":{"url":"http://gcr.io/PROJECT_ID/zhuge-legion"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"gcr.io/PROJECT_ID/zhuge-legion","href":"http://gcr.io/PROJECT_ID/zhuge-legion"},{"type":"text","text":{"content":"\n\n# 2. 部署到 Cloud Run\ngcloud run deploy zhuge-legion \\\n  --image ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\n\n# 2. 部署到 Cloud Run\ngcloud run deploy zhuge-legion \\\n  --image ","href":null},{"type":"text","text":{"content":"gcr.io/PROJECT_ID/zhuge-legion","link":{"url":"http://gcr.io/PROJECT_ID/zhuge-legion"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"gcr.io/PROJECT_ID/zhuge-legion","href":"http://gcr.io/PROJECT_ID/zhuge-legion"},{"type":"text","text":{"content":" \\\n  --platform managed \\\n  --region us-west1 \\\n  --memory 4Gi \\\n  --cpu 2 \\\n  --set-env-vars GEMINI_API_KEY=your-key \\\n  --allow-unauthenticated","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" \\\n  --platform managed \\\n  --region us-west1 \\\n  --memory 4Gi \\\n  --cpu 2 \\\n  --set-env-vars GEMINI_API_KEY=your-key \\\n  --allow-unauthenticated","href":null}],"language":"bash"}},{"object":"block","id":"927bd0ed-59b8-4bb0-9b70-4a094830db6e","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"edb3f528-8861-47da-bd01-a8b5fab7aa36","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"性能优化","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"性能优化","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"e4024678-5e4c-4820-833e-554d13549995","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"1. 模型量化","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1. 模型量化","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"4acb80f8-b56c-4a0d-9c9b-2eb416a2d950","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 如果 INT8 还是太大，可以用 INT4\n# 模型大小：9GB → 4.5GB\n# 推理速度：稍快\n# 质量损失：可接受\n\n# 使用 llama.cpp 转换\npython ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 如果 INT8 还是太大，可以用 INT4\n# 模型大小：9GB → 4.5GB\n# 推理速度：稍快\n# 质量损失：可接受\n\n# 使用 llama.cpp 转换\npython ","href":null},{"type":"text","text":{"content":"convert.py","link":{"url":"http://convert.py/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"convert.py","href":"http://convert.py/"},{"type":"text","text":{"content":" --model yi-6b --quant q4_0","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" --model yi-6b --quant q4_0","href":null}],"language":"bash"}},{"object":"block","id":"6ef49c53-560e-43ca-98e1-6e0a5ba604bb","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"2. 批处理","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"2. 批处理","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f42e6c1c-2ee9-45b5-8922-cb0275003d1e","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// 批量处理任务，复用模型加载\nfunc (l *Legion) DeployBatch(ctx context.Context, missions []string) ([]*Decision, error) {\n    results := make([]*Decision, len(missions))\n    \n    for i, mission := range missions {\n        results[i], _ = l.Deploy(ctx, mission)\n    }\n    \n    return results, nil\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// 批量处理任务，复用模型加载\nfunc (l *Legion) DeployBatch(ctx context.Context, missions []string) ([]*Decision, error) {\n    results := make([]*Decision, len(missions))\n    \n    for i, mission := range missions {\n        results[i], _ = l.Deploy(ctx, mission)\n    }\n    \n    return results, nil\n}","href":null}],"language":"go"}},{"object":"block","id":"e19c4ab3-6b54-4d69-b4b0-32dccda9f687","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"3. 缓存策略","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"3. 缓存策略","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"4c42d681-f076-4cb4-baaf-478076f0d510","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// 使用向量相似度匹配缓存\nfunc (c *VectorCache) FindSimilar(mission string, threshold float64) (*Decision, bool) {\n    vec := embed(mission)\n    \n    for cachedMission, cachedVec := range c.embeddings {\n        similarity := cosineSimilarity(vec, cachedVec)\n        if similarity > threshold {\n            return c.results[cachedMission], true\n        }\n    }\n    \n    return nil, false\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// 使用向量相似度匹配缓存\nfunc (c *VectorCache) FindSimilar(mission string, threshold float64) (*Decision, bool) {\n    vec := embed(mission)\n    \n    for cachedMission, cachedVec := range c.embeddings {\n        similarity := cosineSimilarity(vec, cachedVec)\n        if similarity > threshold {\n            return c.results[cachedMission], true\n        }\n    }\n    \n    return nil, false\n}","href":null}],"language":"go"}},{"object":"block","id":"7138156f-ba27-47f6-b421-f2489923c22d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"f5863a00-aab9-4595-a2b1-858a19a4ded8","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"测试用例","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"测试用例","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f1ed702d-8848-4833-b635-090668dce17a","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"单元测试","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"单元测试","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"1615a84a-28bc-4d02-8511-65e987783af2","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"package legion\n\nimport (\n    \"context\"\n    \"testing\"\n)\n\nfunc TestLegionDeploy(t *testing.T) {\n    // Mock agents\n    agents := createMockAgents()\n    cache := createMockCache()\n    \n    legion := NewLegion(agents, cache, cache)\n    \n    decision, err := legion.Deploy(context.Background(), \"测试任务\")\n    if err != nil {\n        t.Fatalf(\"Deploy failed: %v\", err)\n    }\n    \n    if ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"package legion\n\nimport (\n    \"context\"\n    \"testing\"\n)\n\nfunc TestLegionDeploy(t *testing.T) {\n    // Mock agents\n    agents := createMockAgents()\n    cache := createMockCache()\n    \n    legion := NewLegion(agents, cache, cache)\n    \n    decision, err := legion.Deploy(context.Background(), \"测试任务\")\n    if err != nil {\n        t.Fatalf(\"Deploy failed: %v\", err)\n    }\n    \n    if ","href":null},{"type":"text","text":{"content":"decision.Final","link":{"url":"http://decision.final/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"decision.Final","href":"http://decision.final/"},{"type":"text","text":{"content":" == \"\" {\n        t.Error(\"Empty decision\")\n    }\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" == \"\" {\n        t.Error(\"Empty decision\")\n    }\n}","href":null}],"language":"go"}},{"object":"block","id":"808cd598-e498-4273-915f-67fc2903425e","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"集成测试","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"集成测试","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"19112eba-e52f-488d-86b7-ede0c6d10248","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"#!/bin/bash\n# 启动服务\ngo run cmd/server/main.go &\nSERVER_PID=$!\n\nsleep 5\n\n# 测试 API\nRESPONSE=$(curl -s -X POST ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"#!/bin/bash\n# 启动服务\ngo run cmd/server/main.go &\nSERVER_PID=$!\n\nsleep 5\n\n# 测试 API\nRESPONSE=$(curl -s -X POST ","href":null},{"type":"text","text":{"content":"http://localhost:8080/api/v1/deploy","link":{"url":"http://localhost:8080/api/v1/deploy"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"http://localhost:8080/api/v1/deploy","href":"http://localhost:8080/api/v1/deploy"},{"type":"text","text":{"content":" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"mission\": \"测试任务\"}')\n\necho $RESPONSE | jq '.final'\n\n# 清理\nkill $SERVER_PID","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"mission\": \"测试任务\"}')\n\necho $RESPONSE | jq '.final'\n\n# 清理\nkill $SERVER_PID","href":null}],"language":"bash"}},{"object":"block","id":"db5dd91c-5885-4c73-8df6-78fccf54b9cd","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"b085513e-56a8-46ab-979c-7de5b4ecff04","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"监控与日志","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"监控与日志","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"14ddb104-62b5-4a6d-bd6b-d8b0e6767292","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Prometheus 指标","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Prometheus 指标","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"e1505706-4ace-4963-b26b-6f396aba3354","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"var (\n    requestDuration = prometheus.NewHistogramVec(\n        prometheus.HistogramOpts{\n            Name: \"zhuge_request_duration_seconds\",\n            Help: \"Request duration in seconds\",\n        },\n        []string{\"role\"},\n    )\n    \n    cacheHitRate = prometheus.NewGauge(\n        prometheus.GaugeOpts{\n            Name: \"zhuge_cache_hit_rate\",\n            Help: \"Cache hit rate\",\n        },\n    )\n)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"var (\n    requestDuration = prometheus.NewHistogramVec(\n        prometheus.HistogramOpts{\n            Name: \"zhuge_request_duration_seconds\",\n            Help: \"Request duration in seconds\",\n        },\n        []string{\"role\"},\n    )\n    \n    cacheHitRate = prometheus.NewGauge(\n        prometheus.GaugeOpts{\n            Name: \"zhuge_cache_hit_rate\",\n            Help: \"Cache hit rate\",\n        },\n    )\n)","href":null}],"language":"go"}},{"object":"block","id":"be3d5ef6-d0b3-41d7-84e3-2c13a907ee0b","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"结构化日志","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"结构化日志","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"2640818e-b2c6-4bd2-ad69-e402fa6becff","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"import \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"import \"","href":null},{"type":"text","text":{"content":"github.com/sirupsen/logrus","link":{"url":"http://github.com/sirupsen/logrus"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"github.com/sirupsen/logrus","href":"http://github.com/sirupsen/logrus"},{"type":"text","text":{"content":"\"\n\nlog := logrus.WithFields(logrus.Fields{\n    \"role\":    agent.GetRole(),\n    \"mission\": mission,\n    \"tokens\":  response.Tokens,\n})\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n\nlog := logrus.WithFields(logrus.Fields{\n    \"role\":    agent.GetRole(),\n    \"mission\": mission,\n    \"tokens\":  response.Tokens,\n})\n","href":null},{"type":"text","text":{"content":"log.Info","link":{"url":"http://log.info/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"log.Info","href":"http://log.info/"},{"type":"text","text":{"content":"(\"Agent generated response\")","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\"Agent generated response\")","href":null}],"language":"go"}},{"object":"block","id":"a1ee9be9-8eff-4a15-934b-5667f248cea7","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"f40ae4fe-e06e-4398-a3ae-26a37519bc19","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"安全考虑","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"安全考虑","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"11952a17-f557-4d3b-b874-313d5e41449a","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"1. API Key 管理","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1. API Key 管理","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"c3873af8-b446-42e1-a276-c46ab34dfd10","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// 使用环境变量或 Secret Manager\ngeminiKey := os.Getenv(\"GEMINI_API_KEY\")\nif geminiKey == \"\" {\n    log.Fatal(\"GEMINI_API_KEY not set\")\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// 使用环境变量或 Secret Manager\ngeminiKey := os.Getenv(\"GEMINI_API_KEY\")\nif geminiKey == \"\" {\n    log.Fatal(\"GEMINI_API_KEY not set\")\n}","href":null}],"language":"go"}},{"object":"block","id":"fffcbcdc-a14f-4817-93ef-19dab152fc7a","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"2. 输入验证","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"2. 输入验证","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"29f92b92-21e3-41ef-a1a0-c94eb6d6e3bb","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"func validateMission(mission string) error {\n    if len(mission) == 0 {\n        return ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"func validateMission(mission string) error {\n    if len(mission) == 0 {\n        return ","href":null},{"type":"text","text":{"content":"errors.New","link":{"url":"http://errors.new/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"errors.New","href":"http://errors.new/"},{"type":"text","text":{"content":"(\"empty mission\")\n    }\n    if len(mission) > 10000 {\n        return ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\"empty mission\")\n    }\n    if len(mission) > 10000 {\n        return ","href":null},{"type":"text","text":{"content":"errors.New","link":{"url":"http://errors.new/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"errors.New","href":"http://errors.new/"},{"type":"text","text":{"content":"(\"mission too long\")\n    }\n    return nil\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\"mission too long\")\n    }\n    return nil\n}","href":null}],"language":"go"}},{"object":"block","id":"71e3c64d-ebb1-47c2-a4ab-2d6b080eb5da","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"3. 速率限制","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"3. 速率限制","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"b479cbe3-0f23-4eb0-8ff8-73a6515f08db","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"import \"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"import \"","href":null},{"type":"text","text":{"content":"golang.org/x/time/rate","link":{"url":"http://golang.org/x/time/rate"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"golang.org/x/time/rate","href":"http://golang.org/x/time/rate"},{"type":"text","text":{"content":"\"\n\nlimiter := rate.NewLimiter(10, 100) // 10 req/s, burst 100\n\nif !limiter.Allow() {\n    return ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\"\n\nlimiter := rate.NewLimiter(10, 100) // 10 req/s, burst 100\n\nif !limiter.Allow() {\n    return ","href":null},{"type":"text","text":{"content":"errors.New","link":{"url":"http://errors.new/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"errors.New","href":"http://errors.new/"},{"type":"text","text":{"content":"(\"rate limit exceeded\")\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(\"rate limit exceeded\")\n}","href":null}],"language":"go"}},{"object":"block","id":"170e71e3-5307-48a9-b727-8fcdfa6a2797","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"2b3d065b-5e75-4797-89b0-cc5bcb9d7382","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"故障排查","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"故障排查","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"26fb1fd3-f88f-4b7d-90e4-ba4dd490125b","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"常见问题","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"常见问题","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"3ca765af-c41b-4aa6-a33b-585c1b59849c","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"1. 模型加载失败","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1. 模型加载失败","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"322a6441-c1cf-4da6-a879-5fe2181380a6","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 检查模型文件\nls -lh models/yi-6b-chat-q8_0.gguf\n\n# 验证文件完整性\nsha256sum models/yi-6b-chat-q8_0.gguf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 检查模型文件\nls -lh models/yi-6b-chat-q8_0.gguf\n\n# 验证文件完整性\nsha256sum models/yi-6b-chat-q8_0.gguf","href":null}],"language":"bash"}},{"object":"block","id":"eca11f92-f050-4495-82f0-060a07f7c70a","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"2. 内存不足","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"2. 内存不足","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"aed32044-36b2-46c4-861d-dbd4f3eec0bb","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"# 监控内存使用\ntop -p $(pgrep zhuge-legion)\n\n# 使用更小的量化版本（INT4）\n# 或者减少并发数","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"# 监控内存使用\ntop -p $(pgrep zhuge-legion)\n\n# 使用更小的量化版本（INT4）\n# 或者减少并发数","href":null}],"language":"bash"}},{"object":"block","id":"daaa7871-a026-4bf8-91cd-d490a63bacfc","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"3. Gemini API 超时","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"3. Gemini API 超时","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0a085827-354d-4949-ada6-605a83cecd2d","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// 增加超时时间\nctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\ndefer cancel()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// 增加超时时间\nctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\ndefer cancel()","href":null}],"language":"go"}},{"object":"block","id":"a1e22805-b797-4cfc-94f4-d94deff0de4b","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"b586f57e-a398-40c3-bd76-6c8a354e6d50","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"扩展性设计","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"扩展性设计","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"95325b4a-40f1-4ada-a6a3-c514957d3d7f","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"1. 支持更多模型","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1. 支持更多模型","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"02ebc846-2c93-4987-b128-f8f2e0650f82","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"type ModelBackend interface {\n    Load(path string) error\n    Generate(prompt string, opts ...Option) (string, error)\n    Unload() error\n}\n\n// 可以轻松切换到 Llama 3, Mistral, Qwen 等","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"type ModelBackend interface {\n    Load(path string) error\n    Generate(prompt string, opts ...Option) (string, error)\n    Unload() error\n}\n\n// 可以轻松切换到 Llama 3, Mistral, Qwen 等","href":null}],"language":"go"}},{"object":"block","id":"ce5da484-dad7-485e-8207-b77cbd2892e6","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"2. 支持流式输出","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"2. 支持流式输出","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"9c826a17-c128-4feb-a999-c4ecaf2bc0c1","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"func (a *LocalAgent) GenerateStream(\n    ctx context.Context,\n    prompt string,\n    callback func(token string),\n) error {\n    // 逐 token 生成并回调\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"func (a *LocalAgent) GenerateStream(\n    ctx context.Context,\n    prompt string,\n    callback func(token string),\n) error {\n    // 逐 token 生成并回调\n}","href":null}],"language":"go"}},{"object":"block","id":"acae4e14-487a-4570-ae29-22d3adad9600","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"3. 分布式部署","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"3. 分布式部署","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"cc2f7d20-9ed8-4376-87d6-364b5fba5dfd","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// 使用消息队列解耦\ntype TaskQueue interface {\n    Publish(mission string) error\n    Subscribe(handler func(mission string)) error\n}\n\n// Redis, RabbitMQ, Kafka 等","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// 使用消息队列解耦\ntype TaskQueue interface {\n    Publish(mission string) error\n    Subscribe(handler func(mission string)) error\n}\n\n// Redis, RabbitMQ, Kafka 等","href":null}],"language":"go"}},{"object":"block","id":"d351c5be-780b-4435-ab19-b3b2f4847e60","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"divider","divider":{}},{"object":"block","id":"7e47ed01-563b-48da-b3f7-d5dca35606ce","parent":{"type":"page_id","page_id":"a8125e63-33e1-40a4-8cb3-58c9bb07cfe3"},"created_time":"2025-11-21T17:55:00.000Z","last_edited_time":"2025-11-21T17:57:00.000Z","created_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"last_edited_by":{"object":"user","id":"269d872b-594c-81d1-9fe1-00029c482d4b"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"成本估算","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"成本估算","href":null}],"is_toggleable":false,"color":"default"}}],"next_cursor":"3f5e671f-cef2-4f29-b113-8d5d2fcd9136","has_more":true,"type":"block","block":{},"request_id":"93967364-0c41-4e3c-be16-d522060535b0"}