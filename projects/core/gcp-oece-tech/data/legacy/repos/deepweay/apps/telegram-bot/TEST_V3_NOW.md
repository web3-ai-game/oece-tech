# 🧪 V3系统测试指南

## ✅ 当前状态

**小爱同学V3正在运行！**

---

## 🎯 测试1: 群聊关键词触发

### 小爱同学关键词
```
小爱 你好
小愛 幫忙
xiaoai help
群主 在嗎
管理 來一下
```

### 预期回复
```
@你的用户名 我明白你的感受 😊 [1/5]
```

### 5轮测试
```
第1次: 小爱 你好 → [1/5]
第2次: 小爱 帮忙 → [2/5]
第3次: 小爱 谢谢 → [3/5]
第4次: 小爱 再见 → [4/5]
第5次: 小爱 拜拜 → [5/5]
第6次: 小爱 还在 → [1/5] (重置)
```

---

## 🎯 测试2: 倩倩姐关键词

### 关键词
```
倩倩 在吗
倩倩姐 你好
qianqian hi
女神 帮忙
```

### 预期回复（高冷）
```
@你的用户名 嗯。
@你的用户名 知道了。
@你的用户名 随便。
```

---

## 🎯 测试3: Notion助手关键词

### 关键词
```
notion 帮我查
助手 在吗
知识 分享
专业 解答
```

### 预期回复（专业）
```
@你的用户名 根据我的了解，这个问题需要从多个角度分析 📚
@你的用户名 建议参考相关文献和资料 💡
```

---

## 🎯 测试4: 私聊对话

### 测试步骤
1. 私聊小爱同学
2. 发送: `你好`
3. 预期: `你好！我是小爱同学 😊`
4. 继续对话，Bot会记住所有内容

### 查看私聊记录
```bash
redis-cli lrange "private_chat:xiaoai:你的用户ID" 0 -1
```

---

## 📊 数据查询

### 查看群聊轮次
```bash
# 查看所有轮次
redis-cli keys "group_round:*"

# 查看特定用户
redis-cli get "group_round:xiaoai:-1001234567890:123456789"
```

### 查看私聊记录
```bash
# 查看所有私聊
redis-cli keys "private_chat:*"

# 查看特定对话
redis-cli lrange "private_chat:xiaoai:123456789" 0 -1
```

---

## 🔧 管理命令

### 重启Bot
```bash
pkill -f multi_bot_v3
./run_multi_bots_v3.sh
```

### 清空群聊轮次
```bash
redis-cli keys "group_round:*" | xargs redis-cli del
```

### 删除私聊记录
```bash
redis-cli del "private_chat:xiaoai:你的用户ID"
```

---

## ✅ 成功标志

### 群聊
- ✅ Bot回复包含 `@用户名`
- ✅ Bot回复包含 `[X/5]`
- ✅ 5轮后自动重置
- ✅ 不同Bot独立关键词

### 私聊
- ✅ 直接回复（无需关键词）
- ✅ 记住所有对话
- ✅ 根据历史个性化回复

---

## 🐛 故障排查

### Bot不回复
1. 确认使用了正确的关键词
2. 检查群组隐私模式是否关闭
3. 查看Bot日志

### 轮次不对
```bash
# 清空重新开始
redis-cli flushdb
```

---

## 🎉 V3新特性总结

| 功能 | 说明 |
|------|------|
| 独立关键词 | 每个Bot有自己的触发词 |
| 群聊5轮 | [X/5] 轮次追踪 |
| 私聊永久 | 保存所有对话 |
| 上下文记忆 | 根据历史回复 |
| 双模式 | 群聊/私聊不同逻辑 |

---

**现在就去测试吧！** 🚀

群聊发送: `小爱 你好`
私聊发送: `你好`
