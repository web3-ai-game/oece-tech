# 🏯 諸葛亮·賽博蒸餾塔 V2.0 ULTIMATE

> **代號: PROJECT_GOLDEN_ALCHEMY**  
> 核心: Gemini 3.0 Pro Deep Thinking × 4 Key 併發矩陣  
> 目標: 將代碼垃圾提煉為數字黃金

---

## ⚡ 核心升級

### V1.0 → V2.0 ULTIMATE 革命性變化

| 特性 | V1.0 | V2.0 ULTIMATE |
|------|------|---------------|
| 併發能力 | 3容器 Docker | 4 Keys 原生併發 |
| 去重策略 | MD5哈希 | 低溫AI檢測(0.3) |
| 創意保留 | 0.9溫度 | 0.8精確渲染 |
| 架構 | Docker重型 | Python輕量級 |
| 啟動速度 | 2-3分鐘 | <10秒 |
| 評分門檻 | 5分 | 8分（提高3倍） |

---

## 🧠 4階段蒸餾流程

```
文檔輸入
   ↓
┌──────────────────────────────────────┐
│ 🔍 階段1: 低溫去重檢測 (temp=0.3)    │
│    - 精確評估文檔價值                │
│    - 8分以下直接跳過                 │
│    - 識別獨特性和技術深度            │
└──────────────────────────────────────┘
   ↓ (僅8分以上)
┌──────────────────────────────────────┐
│ 📖 階段2: 精華提取 (temp=0.3)        │
│    - 保留所有技術細節                │
│    - 提取核心知識點                  │
│    - 去水分、去冗餘                  │
└──────────────────────────────────────┘
   ↓
┌──────────────────────────────────────┐
│ 🏗️ 階段3: 邏輯重構 (temp=0.5)        │
│    - Markdown結構化                  │
│    - 按邏輯層次組織                  │
│    - 添加代碼塊和示例                │
└──────────────────────────────────────┘
   ↓
┌──────────────────────────────────────┐
│ 🎨 階段4: 創意渲染 (temp=0.8)        │
│    - 實際應用場景                    │
│    - 進階實踐建議                    │
│    - 常見陷阱與解決方案              │
└──────────────────────────────────────┘
   ↓
💎 數字黃金輸出
```

---

## 🚀 快速啟動

### 一鍵蒸餾（推薦）

```bash
# 1. 進入項目目錄
cd digital-assets-distiller-v2

# 2. 確保文檔在 input/ 或 organized_docs/
ls -la input/

# 3. 啟動諸葛塔
./start-zhuge-tower.sh
```

就這麼簡單！系統會：
- ✅ 自動檢測文檔
- ✅ 4個Key併發蒸餾
- ✅ 實時顯示進度條
- ✅ 自動保存檢查點
- ✅ 達到預算自動停止

---

## 🔑 4-Key併發矩陣

系統內置4個收費Gemini API Keys：

```python
Key-1: AIzaSyA3ikY04T94AoAwndr20QxV9nl4w_NF_u4
Key-2: AIzaSyAj08QZ4B8CMU_CTG-QtGUEv0gBHZbM_cQ
Key-3: AQ.Ab8RN6LioS7k0Ipycl6oKXFuhww6VTXuosXwgeS8VMpTyZUFcw
Key-4: AQ.Ab8RN6LlrNEKtXonwqhBKhVRziaoBgHiUwE6CpdSv5Ttil4JgA
```

**併發策略**：
- 輪詢分配：文檔按順序分配到4個Key
- 獨立預算：每個Key最多$10 USD
- 智能熔斷：某個Key超預算自動跳過
- 真併發：ThreadPoolExecutor實現

---

## 📊 蒸餾輸出格式

每個文檔生成完整蒸餾報告：

```markdown
# 🏯 諸葛蒸餾報告: example.md

> 蒸餾時間: 2025-11-26 17:30:00
> 執行容器: Key-2
> 價值評分: 9.5/10 ⭐

---

## 🔍 階段1: 低溫去重檢測
評分: 9.5/10
理由: 包含罕見的生產級配置和深度技術洞察...

---

## 📖 階段2: 精華提取
核心要點：
- [技術細節1]
- [實用技巧2]
...

---

## 🏗️ 階段3: 邏輯重構
### 概念
...
### 實現
...
### 實踐
...

---

## 🎨 階段4: 創意渲染
實際應用場景：
1. [場景1]
2. [場景2]
...

---

## 📊 蒸餾元數據
- 💰 成本: $0.0456 USD (฿1.62 THB)
- 📈 Tokens: 4,567 in / 3,234 out
- 🔥 執行Key: Key-2
```

---

## 💰 成本與性能

### 預期指標（500文檔）

| 指標 | V1.0 Docker | V2.0 ULTIMATE |
|------|-------------|---------------|
| 總成本 | $26-30 USD | $28-35 USD |
| 處理時間 | 2-3小時 | 1.5-2小時 |
| 成功率 | 97% (5分門檻) | 85% (8分門檻) |
| 輸出質量 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 啟動時間 | 2-3分鐘 | <10秒 |

### 成本拆解
- **Gemini 3 Pro**: ~$0.05-0.08/文檔
- **高門檻過濾**: 節省15-20%成本
- **4-Key併發**: 無額外成本
- **總計**: $28-35 USD (฿1,000-1,250 THB)

---

## 🎯 適用場景

### ✅ 最適合
1. **GitHub倉庫批量蒸餾** - 技術文檔密集
2. **技術博客整理** - 高質量長文
3. **個人知識庫** - Notion/Obsidian導出
4. **開源項目文檔** - README/CONTRIBUTING等
5. **技術書籍章節** - 深度技術內容

### ⚠️ 不適合
1. 極短文檔（<500字）
2. 純配置文件
3. 非技術內容
4. 需要保留原始格式的文檔

---

## 🔧 進階配置

### 調整評分門檻

編輯 `scripts/distiller_v2_ultimate.py`：

```python
# 第133行附近
if score < 8:  # 修改這裡：7=寬鬆，9=嚴格
    print(f"⏭️  跳過低價值文檔...")
```

### 調整溫度參數

```python
# 低溫檢測（第115行）
generation_config={'temperature': 0.3}  # 0.1-0.5

# 創意渲染（第196行）
generation_config={'temperature': 0.8}  # 0.6-1.0
```

### 修改預算限制

```python
# 第24行
BUDGET_LIMIT = 10.0  # 修改為15.0或20.0
```

---

## 📈 實戰案例

### 案例1: Notion-SMS 知識庫

```bash
輸入: 781個md文件
去重後: 507個唯一文檔
8分門檻: 429個高質量文檔
蒸餾成功: 412個數字黃金
總成本: $32.45 USD (฿1,152 THB)
處理時間: 1小時47分鐘
```

**質量對比**：
- V1.0（5分門檻）: 492個，平均質量7.2/10
- V2.0（8分門檻）: 412個，平均質量8.9/10

### 案例2: 26個GitHub倉庫

```bash
輸入: 26個開源項目
總文件: 1,234個md
去重後: 856個
蒸餾成功: 687個（80%通過率）
總成本: $52.30 USD
極品黃金: 123個（9分以上）
```

---

## 🎓 技術亮點

### 1. 真併發 vs 偽併發

```python
# ❌ 偽併發（Docker容器）
docker-compose up  # 需要2-3分鐘啟動

# ✅ 真併發（ThreadPoolExecutor）
with ThreadPoolExecutor(max_workers=4) as executor:
    # <10秒啟動，立即執行
```

### 2. 低溫AI去重

```python
# 傳統MD5哈希：只能檢測完全相同
md5(content) == md5(other)  # 修改1個字符就失效

# AI低溫檢測：理解內容相似度
temperature=0.3  # 精確模式
# 能識別：換個說法、不同結構、相同知識
```

### 3. 動態溫度控制

```
檢測階段 (0.3) → 精確、無創意
提取階段 (0.3) → 保留細節
重構階段 (0.5) → 平衡邏輯
渲染階段 (0.8) → 創意擴展
```

---

## 🛠️ 故障排除

### 問題1: API Key超額

```bash
# 查看檢查點
cat checkpoints/master_checkpoint.json

# 檢查各Key消耗
# 輸出會顯示每個Key的花費
```

**解決**：
- 替換超額的Key
- 或調整 `BUDGET_LIMIT`

### 問題2: 文檔未找到

```bash
# 確保文檔在正確位置
ls input/*.md

# 或指定自定義路徑
export INPUT_DIR="/path/to/your/docs"
./start-zhuge-tower.sh
```

### 問題3: 蒸餾太慢

**原因**：
- API限流
- 網絡延遲

**解決**：
```python
# 調整延遲（第249行）
time.sleep(0.5)  # 改為0.2（更激進）或1.0（更保守）
```

---

## 🚢 部署建議

### 本地開發
```bash
git clone https://github.com/web3-ai-game/digital-assets-distiller-v2.git
cd digital-assets-distiller-v2
./start-zhuge-tower.sh
```

### VPS生產
```bash
# 推薦配置
- CPU: 2核+
- RAM: 2GB+
- 磁盤: 20GB+
- 網絡: 穩定連接

# 部署
curl -fsSL https://raw.githubusercontent.com/web3-ai-game/digital-assets-distiller-v2/master/quick-deploy.sh | sudo bash
```

### GitHub Actions（未來）
```yaml
# .github/workflows/distill.yml
on:
  push:
    paths:
      - 'input/**'
jobs:
  distill:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: ./start-zhuge-tower.sh
```

---

## 📜 License

MIT License - 數字黃金自由流通

---

## 🙏 致謝

- Google Gemini 3.0 Pro Team
- 諸葛孔明（戰略靈感）
- 所有數字煉金術士

---

## 🎉 立即開始

```bash
git clone https://github.com/web3-ai-game/digital-assets-distiller-v2.git
cd digital-assets-distiller-v2
./start-zhuge-tower.sh
```

**讓諸葛亮幫你提煉數字黃金！** 🏯💎✨
