# 🎯 SVSKILO TG Bot 配置完成摘要

> **時間**: 2025-11-26  
> **專案**: 向量垃圾話噴射器 (僅 SVSKILO 帳戶)

---

## ✅ 已完成的工作

### 1. 清理舊配置 🧹

| 刪除項目 | 原因 |
|---------|------|
| ❌ `sms-key/.env.doppler` | 包含舊 Doppler 配置和其他帳戶 token |
| ❌ `.env.local` | 根目錄舊環境變量 |
| ❌ 舊 PM2 服務 | 已停止並刪除舊的 tg-trash-bot 實例 |

### 2. 創建新專案結構 📦

```
tg-trash-bot/
├── index.js              # 主程序 (8 種 AI 人格)
├── package.json          # 依賴配置
├── ecosystem.config.js   # PM2 配置
├── Dockerfile           # 容器化配置
├── .dockerignore        # Docker 忽略檔案
├── .env.example         # 環境變量模板 ⭐
├── start.sh             # 快速啟動腳本 ⭐
├── SETUP.md             # 詳細配置指南 ⭐
└── README.md            # 使用說明

logs/                    # PM2 日誌目錄
├── error.log
└── out.log
```

### 3. 核心功能 🎭

- ✅ **8 種神經病 AI 人格**: 暴躁老哥、街頭哲學家、科技狂熱者、碎嘴老媽、廢話詩人、假掰網紅、瘋狂科學家、中二病患者
- ✅ **免費模型**: Gemini 2.5 Flash-Lite (15 RPM, 250K TPM) - **絕對能用!**
- ✅ **速率保護**: 自動限流 + 排隊機制
- ✅ **容器化**: Docker + PM2 部署
- ✅ **零成本**: 100% 使用免費 API

---

## 🔑 下一步: 填入你的新 Token

### 步驟 1: 創建 .env 檔案

```bash
cd /home/svs-main-key/GCP/tg-trash-bot
cp .env.example .env
nano .env  # 或使用 vim
```

### 步驟 2: 填入以下內容

```bash
# SVSKILO Bot Token (替換成你的新 token)
TELEGRAM_BOT_SVSKILO_TOKEN="你從 @BotFather 獲取的新 token"

# Gemini 免費 Key (如果你有新的 key,替換它)
GEMINI_FREE_KEY="你的 Gemini 免費 key"

# (可選) Gemini 付費 Keys
GEMINI_PRO_30_KEY="你的 Gemini 3 Pro key"
GEMINI_PRO_25_KEY="你的 Gemini 2.5 Flash key"

NODE_ENV="production"
```

### 步驟 3: 啟動 Bot

```bash
# 方式 1: 使用快速啟動腳本 (推薦)
cd /home/svs-main-key/GCP/tg-trash-bot
./start.sh

# 方式 2: 手動 PM2 啟動
pm2 start ecosystem.config.js

# 方式 3: 直接啟動 (開發測試)
npm start
```

---

## 📋 獲取新 Token 的方法

### Telegram Bot Token (@BotFather)

1. 在 Telegram 搜索 `@BotFather`
2. 發送 `/newbot`
3. 設置 bot 名稱 (例如: `SVSKILO Trash Talker`)
4. 設置 bot 用戶名 (例如: `svskilo_trash_bot`)
5. 複製返回的 Token:
   ```
   123456789:ABCdefGHIjklMNOpqrsTUVwxyz
   ```
6. 填入 `.env` 檔案的 `TELEGRAM_BOT_SVSKILO_TOKEN`

### Gemini API Key

1. 前往 [Google AI Studio](https://aistudio.google.com/app/apikey)
2. 登入 Google 帳戶
3. 點擊 **"Get API Key"** → **"Create API Key"**
4. 選擇專案 (或創建新專案)
5. 複製生成的 Key:
   ```
   AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
   ```
6. 填入 `.env` 檔案的 `GEMINI_FREE_KEY`

---

## 🧪 測試指令

### 測試 Gemini API

```bash
cd /home/svs-main-key/GCP/tg-trash-bot
source .env

node -e "
const axios = require('axios');
axios.post(
  'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite:generateContent?key=' + process.env.GEMINI_FREE_KEY,
  { contents: [{ parts: [{ text: '測試' }] }] }
).then(r => console.log('✅ Gemini API 正常:', r.data.candidates[0].content.parts[0].text))
 .catch(e => console.error('❌ API 錯誤:', e.response?.data || e.message));
"
```

### 測試 TG Bot

1. 在 Telegram 搜索你的 bot 用戶名
2. 發送 `/start` 查看歡迎信息
3. 發送任意文字測試垃圾話生成

---

## 🎯 Bot 命令列表

| 命令 | 功能 |
|------|------|
| `/start` | 顯示歡迎信息和 8 種人格列表 |
| `/personas` | 查看所有人格詳細描述 |
| `/stats` | 查看當前調用統計 (RPM 使用情況) |
| 任意文字 | 隨機人格回覆垃圾話 (temperature 0.85-0.95) |

---

## 📊 Key 調用策略 (時間就是金錢!)

### 付費優先爆射 💰

| 模型 | RPM | 用途 | 成本 |
|------|-----|------|------|
| **gemini-3-pro-preview** | 25 | 深度思考/向量代碼/Notion清洗 | $1.25/1M in, $5/1M out |
| gemini-2.5-flash | 15 | 快速代碼生成 | $0.075/1M in, $0.30/1M out |

### 免費兜底高頻噴 🎉

| 模型 | RPM | 用途 | 成本 |
|------|-----|------|------|
| **gemini-2.5-flash-lite** | **15** | **TG 垃圾話** | **FREE** ✅ |
| gemini-2.0-flash-lite | 15 | 備用高頻 | FREE |
| gemini-2.0-flash | 10 | 備用穩定 | FREE |

> 詳細策略請參考: `KEY_調用策略_速率優先版.md`

---

## 🔧 常用命令

```bash
# 查看 PM2 狀態
pm2 status

# 查看實時日誌
pm2 logs tg-trash-bot

# 查看最近 50 行日誌
pm2 logs tg-trash-bot --lines 50

# 重啟 Bot
pm2 restart tg-trash-bot

# 停止 Bot
pm2 stop tg-trash-bot

# 完全刪除 (需重新啟動)
pm2 delete tg-trash-bot
```

---

## ⚠️ 安全提醒

1. **不要提交 .env 到 Git**
   ```bash
   # .env 已在 .gitignore 中
   echo ".env" >> .gitignore
   ```

2. **Token 安全**
   - 不要在公開渠道分享 Token
   - 定期輪換 Token (建議 3-6 個月)
   - 如果 Token 洩漏,立即前往 @BotFather 撤銷

3. **Bot 權限**
   - 只給必要的群組添加 Bot
   - 不要給 Bot 管理員權限 (除非必要)

---

## 📦 Git 提交記錄

```
commit 795ba74
🎭 SVSKILO TG Bot 向量垃圾話噴射器 | 清理舊配置,僅保留 svskilo 帳戶

✅ 新增功能:
- 8 種神經病 AI 人格隨機噴射
- Gemini 2.5 Flash-Lite 免費模型 (15 RPM)
- 速率限制保護 + 自動排隊
- Docker + PM2 容器化部署

🧹 清理內容:
- 刪除 sms-key/.env.doppler
- 刪除 .env.local
- 移除所有非 svskilo 的 bot token

📦 新增檔案:
- tg-trash-bot/ (完整專案)
- KEY_調用策略_速率優先版.md
- SETUP.md (詳細配置指南)
- start.sh (快速啟動腳本)
```

---

## 🚀 快速回顧

### 你現在需要做的:

1. ✅ **獲取新 Token**: 從 @BotFather 和 Google AI Studio
2. ✅ **填入 .env**: `cp .env.example .env && nano .env`
3. ✅ **啟動 Bot**: `./start.sh` 或 `pm2 start ecosystem.config.js`
4. ✅ **測試 Bot**: 在 Telegram 發送 `/start`

### 所有相關文檔:

- 📘 **SETUP.md** - 完整配置指南
- 📗 **README.md** - Bot 使用說明
- 📙 **KEY_調用策略_速率優先版.md** - 付費/免費 key 策略
- 📕 **start.sh** - 一鍵啟動腳本

---

## 🎉 完成狀態

| 任務 | 狀態 |
|------|------|
| 清理舊配置 | ✅ 已完成 |
| 創建新專案 | ✅ 已完成 |
| 配置模板 | ✅ 已完成 |
| 啟動腳本 | ✅ 已完成 |
| Git 提交 | ✅ 已推送到 main |
| **等待填入新 Token** | ⏳ **你的下一步** |

---

**準備就緒!** 🎭  
填入新 Token 後執行 `./start.sh`,你的 SVSKILO 向量垃圾話噴射器就能開始瘋狂工作了!

---

**更新時間**: 2025-11-26  
**Git Commit**: 795ba74  
**專案路徑**: `/home/svs-main-key/GCP/tg-trash-bot/`  
**狀態**: ✅ **配置完成,等待新 Token**
