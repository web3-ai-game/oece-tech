rules_version = '2';

// ğŸ”¥ ç«è¨ˆåŠƒ Firestore è¦å‰‡
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ç”¨æˆ¶è³‡æ–™ - æœ¬äººå¯è®€å¯«
    match /users/{userId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // è«–å£‡å¸–å­ - ç™»éŒ„ç”¨æˆ¶å¯è®€ï¼Œä½œè€…å¯å¯«
    match /posts/{postId} {
      allow read: if true;
      allow create: if request.auth != null;
      allow update, delete: if request.auth != null && 
        resource.data.authorId == request.auth.uid;
    }
    
    // çŸ¥è­˜åº« - å…¬é–‹å¯è®€
    match /knowledge/{docId} {
      allow read: if true;
      allow write: if false;
    }
    
    // AI å°è©±è¨˜éŒ„
    match /conversations/{convId} {
      allow read, write: if request.auth != null;
    }
    
    // å‘é‡å­˜æª”
    match /vectors/{vectorId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
  }
}
