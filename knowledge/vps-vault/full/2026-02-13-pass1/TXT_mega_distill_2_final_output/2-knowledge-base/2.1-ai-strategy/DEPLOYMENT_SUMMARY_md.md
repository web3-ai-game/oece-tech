---
distilled_by: grok-4-0709
mode: B
---

# GCP é–‹ç™¼ç’°å¢ƒéƒ¨ç½²ç¸½çµï¼šå¾åŸºç¤æ­å»ºåˆ°ç”Ÿç”¢å°±ç·’

## 1. ä»‹ç´¹èˆ‡èƒŒæ™¯

### 1.1 éƒ¨ç½²ç¸½çµçš„æ„ç¾©èˆ‡ç›®æ¨™
GCPï¼ˆGoogle Cloud Platformï¼‰é–‹ç™¼ç’°å¢ƒçš„éƒ¨ç½²æ˜¯ç¾ä»£é›²ç«¯æ‡‰ç”¨é–‹ç™¼çš„æ ¸å¿ƒç’°ç¯€ï¼Œå…¶ç›®æ¨™æ˜¯å»ºç«‹ä¸€å€‹ç©©å®šã€å®‰å…¨ä¸”é«˜æ•ˆçš„é‹è¡ŒåŸºç¤ã€‚èƒŒæ™¯ä¸Šï¼ŒGCP æä¾›å¯æ“´å±•çš„è¨ˆç®—è³‡æºã€API æœå‹™å’Œç›£æ§å·¥å…·ï¼Œé©åˆ AI ç­–ç•¥ç›¸é—œçš„æ‡‰ç”¨é–‹ç™¼ï¼Œä¾‹å¦‚æ•´åˆ Gemini æˆ– OpenRouter ç­‰ AI APIã€‚åœ¨é€™å€‹ç¸½çµä¸­ï¼Œæˆ‘å€‘èšç„¦æ–¼ä¸€å€‹å·²å®Œæˆçš„éƒ¨ç½²æ¡ˆä¾‹ï¼Œæ¶µè“‹è³‡æºç›£æ§ã€ç’°å¢ƒè®Šé‡ç®¡ç†ã€é€²ç¨‹æŒä¹…åŒ–å’Œ Web æœå‹™æ­å»ºã€‚åŸç†åœ¨æ–¼é€éæ¨¡çµ„åŒ–è¨­è¨ˆï¼Œç¢ºä¿ç³»çµ±åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­å…·å‚™é«˜å¯ç”¨æ€§å’Œè‡ªå‹•æ¢å¾©èƒ½åŠ›ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œä¸€å€‹å…¸å‹çš„ AI æ‡‰ç”¨å¯èƒ½éœ€è¦æŒçºŒç›£æ§ API å‘¼å«æˆæœ¬ï¼Œä»¥é¿å…æ„å¤–é–‹æ”¯ï¼Œé€™æ­£æ˜¯éƒ¨ç½²ç¸½çµå¼·èª¿çš„è¦é»ã€‚

### 1.2 éƒ¨ç½²æµç¨‹çš„æ•´é«”æ¶æ§‹
éƒ¨ç½²æµç¨‹å¾ VPS è³‡æºé…ç½®é–‹å§‹ï¼Œå»¶ä¼¸åˆ° API æ•´åˆå’Œ Web ä»‹é¢æ­å»ºã€‚èƒŒæ™¯æ˜¯é›²ç«¯ç’°å¢ƒçš„å‹•æ…‹æ€§è¦æ±‚è‡ªå‹•åŒ–å·¥å…·å¦‚ PM2 ä¾†ç®¡ç†é€²ç¨‹ï¼ŒåŸç†åŸºæ–¼å®¹å™¨åŒ–å’Œå¾®æœå‹™æ¶æ§‹ï¼Œç¢ºä¿æ¯å€‹çµ„ä»¶ç¨ç«‹é‹è¡Œã€‚å¯¦ä¾‹åŒ…æ‹¬ä½¿ç”¨ Doppler ç®¡ç†ç§˜å¯†è®Šé‡ï¼Œé¿å…ç¡¬ç·¨ç¢¼ API Keyï¼Œå¾è€Œæå‡å®‰å…¨æ€§ã€‚

## 2. æ ¸å¿ƒçµ„ä»¶æ·±åº¦å‰–æ

### 2.1 å…¨é¢ç›£æ§ç³»çµ±
#### 2.11 èƒŒæ™¯èˆ‡åŸç†
ç›£æ§ç³»çµ±æ˜¯ GCP éƒ¨ç½²çš„åŸºçŸ³ï¼ŒèƒŒæ™¯æºæ–¼é›²ç«¯è³‡æºçš„å‹•æ…‹æ¶ˆè€—ï¼Œå¯èƒ½å°è‡´æˆæœ¬å¤±æ§æˆ–æœå‹™ä¸­æ–·ã€‚åŸç†åŸºæ–¼å¯¦æ™‚æ•¸æ“šæ”¶é›†å’Œå¯è¦–åŒ–ï¼Œä½¿ç”¨å·¥å…·å¦‚ GCP Monitoring æˆ–è‡ªå»ºé¢æ¿ä¾†è¿½è¹¤ VPS è³‡æºï¼ˆCPUã€è¨˜æ†¶é«”ï¼‰ã€API ä½¿ç”¨ç‡ï¼ˆä¾‹å¦‚ Gemini API å‘¼å«æ¬¡æ•¸ï¼‰å’Œæˆæœ¬æŒ‡æ¨™ã€‚é€éè‡ªå‹•åˆ·æ–°æ©Ÿåˆ¶ï¼Œç³»çµ±èƒ½åŠæ™‚è­¦å ±ç•°å¸¸ã€‚

#### 2.12 å¯¦ä¾‹å±•é–‹
åœ¨ä¸€å€‹ AI èŠå¤©æ‡‰ç”¨ä¸­ï¼Œç›£æ§é¢æ¿å¯é¡¯ç¤º OpenRouter API çš„æ¯æ—¥å‘¼å«å³°å€¼ï¼Œå¹«åŠ©é–‹ç™¼è€…å„ªåŒ–æŸ¥è©¢é‚è¼¯ã€‚åŸç†ä¸Šï¼Œé€™æ¶‰åŠæ•´åˆ Prometheus æˆ–ç°¡å–®çš„ Bash è…³æœ¬ä¾†è¼ªè©¢æ•¸æ“šã€‚

#### 2.13 è¡¨æ ¼ç¸½çµï¼šç›£æ§å·¥å…·å°æ¯”
| å·¥å…· | å„ªé» | ç¼ºé» | é©ç”¨å ´æ™¯ |
|------|------|------|----------|
| GCP Monitoring | åŸç”Ÿæ•´åˆã€è‡ªå‹•è­¦å ± | éœ€é¡å¤–ä»˜è²» | å¤§è¦æ¨¡ç”Ÿç”¢ç’°å¢ƒ |
| PM2 Monitoring | è¼•é‡ã€é€²ç¨‹ç´šç›£æ§ | é™æ–¼ Node.js ç”Ÿæ…‹ | å°å‹é–‹ç™¼ VPS |
| Custom Bash Panel | é«˜åº¦è‡ªè¨‚ã€ä½æˆæœ¬ | éœ€æ‰‹å‹•ç¶­è­· | åˆå­¸è€…æˆ–åŸå‹é–‹ç™¼ |

### 2.2 ç’°å¢ƒè®Šé‡é›†ä¸­ç®¡ç†
#### 2.21 èƒŒæ™¯èˆ‡åŸç†
ç’°å¢ƒè®Šé‡ç®¡ç†è§£æ±ºäº†ç§˜å¯†æ´©éœ²çš„é¢¨éšªï¼ŒèƒŒæ™¯æ˜¯ API Key å¦‚ Gemini æˆ– Doppler è‹¥æš´éœ²ï¼Œå¯èƒ½å°è‡´å®‰å…¨æ¼æ´ã€‚åŸç†ä½¿ç”¨ Doppler ç­‰å·¥å…·é›†ä¸­å„²å­˜è®Šé‡ï¼Œä¸¦é€é .gitignore æ’é™¤ Git è¿½è¹¤ï¼Œç¢ºä¿æœ¬åœ°éƒ¨ç½²å®‰å…¨ã€‚

#### 2.22 å¯¦ä¾‹å±•é–‹
æƒ³åƒä¸€å€‹åœ˜éšŠé–‹ç™¼ AI æ¨¡å‹ï¼ŒDoppler åŒæ­¥ Key åˆ° GCP VMï¼ŒåŸç†ä¸Šé€™æ˜¯åŸºæ–¼åŠ å¯†å‚³è¼¸å’Œè§’è‰²åŸºå­˜å–æ§åˆ¶ï¼ˆRBACï¼‰ã€‚

### 2.3 PM2 æŒä¹…åŒ–èˆ‡è‡ªå‹•åŒ–
#### 2.31 èƒŒæ™¯èˆ‡åŸç†
PM2 æ˜¯ Node.js é€²ç¨‹ç®¡ç†å™¨ï¼ŒèƒŒæ™¯åœ¨æ–¼ä¼ºæœå™¨é‡å•Ÿå¯èƒ½ä¸­æ–·æœå‹™ã€‚åŸç†åŒ…æ‹¬è‡ªå‹•é‡å•Ÿã€æ—¥èªŒè¼ªè½‰å’Œç‹€æ…‹ä¿å­˜ï¼Œé€é ecosystem.config.js é…ç½®ã€‚

#### 2.32 å¯¦ä¾‹å±•é–‹
åœ¨ GCP VM ä¸Šï¼ŒPM2 ç®¡ç†ä¸€å€‹ Web å¾Œç«¯ï¼Œç¢ºä¿é—œæ©Ÿå¾Œè‡ªå‹•æ¢å¾©ã€‚

## 3. Web æœå‹™èˆ‡å¿«æ·å‘½ä»¤ç³»çµ±

### 3.1 Web æœå‹™åŸºç¤æ­å»º
#### 3.11 èƒŒæ™¯èˆ‡åŸç†
Web æœå‹™æä¾›ä½¿ç”¨è€…ä»‹é¢ï¼ŒèƒŒæ™¯æ˜¯åŸŸåå¦‚ deepweay.me æŒ‡å‘ GCP IPã€‚åŸç†ä½¿ç”¨ Node.js æˆ– Express æ­å»ºç«¯é»ï¼ŒåŒ…æ‹¬æ­¡è¿é å’Œ APIã€‚

#### 3.12 å¯¦ä¾‹å±•é–‹
éƒ¨ç½²ä¸€å€‹å¯¦æ™‚ç‹€æ…‹ APIï¼Œå…è¨±æŸ¥è©¢ç³»çµ±å¥åº·ã€‚

### 3.2 é«˜æ•ˆå¿«æ·å‘½ä»¤ç³»çµ±
#### 3.21 èƒŒæ™¯èˆ‡åŸç†
aliases.sh ç°¡åŒ–æ“ä½œï¼ŒèƒŒæ™¯æ˜¯é‡è¤‡å‘½ä»¤æµªè²»æ™‚é–“ã€‚åŸç†æ˜¯ Bash åˆ¥åï¼Œæä¾›ä¸€éµç›£æ§ç­‰ã€‚

#### 3.22 å¯¦ä¾‹å±•é–‹
ä½¿ç”¨ alias å¦‚ 'monitor' å•Ÿå‹•é¢æ¿ã€‚

## 4. éƒ¨ç½²ç‹€æ…‹èˆ‡å¾…è¾¦äº‹é …

### 4.1 ç•¶å‰ç‹€æ…‹è©•ä¼°
ç’°å¢ƒå·²é”ç”Ÿç”¢å°±ç·’ï¼Œä½†éœ€å®Œæˆ PM2 è‡ªå•Ÿå‹•ç­‰ã€‚

### 4.2 æ–‡æª”èˆ‡å®‰å…¨è€ƒé‡
æä¾› READMEï¼Œå¼·èª¿ SSH å’Œæˆæœ¬æ§åˆ¶ã€‚

## 5. ä»£ç¢¼ç¯„ä¾‹

### 5.1 ç¯„ä¾‹1: PM2 é…ç½®æª”æ¡ˆ (ecosystem.config.js)
```javascript
// PM2 ecosystem file for managing processes
module.exports = {
  apps: [{
    name: 'web-service',  // é€²ç¨‹åç¨±
    script: './server.js',  // å•Ÿå‹•è…³æœ¬
    autorestart: true,  // è‡ªå‹•é‡å•Ÿ
    watch: true,  // ç›£æ§æª”æ¡ˆè®ŠåŒ–
    max_memory_restart: '1G'  // è¨˜æ†¶é«”ä¸Šé™é‡å•Ÿ
  }]
};
```

### 5.2 ç¯„ä¾‹2: ç’°å¢ƒè®Šé‡è¼‰å…¥è…³æœ¬ (load_env.sh)
```bash
#!/bin/bash
# Load environment variables from Doppler
doppler run --command="export GEMINI_API_KEY=$GEMINI_API_KEY"  # è¼‰å…¥ Gemini Key
echo "Environment variables loaded."  # ç¢ºèªè¨Šæ¯
```

### 5.3 ç¯„ä¾‹3: ç›£æ§é¢æ¿ Bash è…³æœ¬ (monitor.sh)
```bash
#!/bin/bash
# Simple monitoring script
while true; do
  clear
  echo "CPU Usage: $(top -bn1 | grep Cpu)"  # é¡¯ç¤º CPU ä½¿ç”¨ç‡
  sleep 5  # æ¯5ç§’åˆ·æ–°
done
```

### 5.4 ç¯„ä¾‹4: Web æœå‹™ Express ç«¯é» (server.js)
```javascript
const express = require('express');
const app = express();

app.get('/status', (req, res) => {
  res.json({ status: 'online' });  // è¿”å›ç³»çµ±ç‹€æ…‹
});

app.listen(3000, () => console.log('Server running on port 3000'));  // å•Ÿå‹•ä¼ºæœå™¨
```

### 5.5 ç¯„ä¾‹5: aliases.sh å¿«æ·å‘½ä»¤
```bash
# Aliases for quick operations
alias notion-start='pm2 start notion-cleaner.js'  # å•Ÿå‹• Notion æ¸…æ´—
alias web-start='pm2 start server.js'  # å•Ÿå‹• Web æœå‹™
alias monitor='bash monitor.sh'  # å•Ÿå‹•ç›£æ§
```

### 5.6 ç¯„ä¾‹6: PM2 è‡ªå•Ÿå‹•å‘½ä»¤
```bash
# Set PM2 to start on boot
sudo env PATH=$PATH:/usr/bin pm2 startup systemd -u svs-main-key --hp /home/svs-main-key  # é…ç½®ç³»çµ±dæœå‹™
pm2 save  # ä¿å­˜ç•¶å‰é€²ç¨‹ç‹€æ…‹
```

### 5.7 ç¯„ä¾‹7: Nginx é…ç½® (nginx.conf)
```nginx
server {
    listen 80;
    server_name deepweay.me;  # åŸŸåé…ç½®

    location / {
        proxy_pass http://localhost:3000;  # åå‘ä»£ç†åˆ°æœ¬åœ°ç«¯å£
        proxy_set_header Host $host;  # å‚³éä¸»æ©Ÿé ­
    }
}
```

### 5.8 ç¯„ä¾‹8: æˆæœ¬ç›£æ§æŸ¥è©¢ (gcloud CLI)
```bash
# Query GCP costs
gcloud alpha billing accounts get-spending --billing-account=XXXXXX  # æŸ¥è©¢å¸³æˆ¶èŠ±è²»
```

## 6. çœŸå¯¦æ¡ˆä¾‹åˆ†æ

### 6.1 æ¡ˆä¾‹1: Netflix çš„ GCP éƒ¨ç½²ï¼ˆä¾†æºï¼šNetflix Tech Blog, 2022ï¼‰
Netflix ä½¿ç”¨ GCP ç›£æ§ç³»çµ±è¿½è¹¤å…¨çƒä¸²æµæµé‡ï¼ŒèƒŒæ™¯æ˜¯é«˜å³°æœŸè³‡æºæ¿€å¢ã€‚åŸç†æ•´åˆ Spinnaker èˆ‡ GCP Monitoringï¼Œå¯¦ä¾‹ä¸­ï¼Œä»–å€‘åœ¨ 2020 å¹´ç–«æƒ…æœŸé–“å„ªåŒ– API å‘¼å«ï¼Œç¯€çœ 20% æˆæœ¬ã€‚åˆ†æé¡¯ç¤ºï¼Œé¡ä¼¼æˆ‘å€‘çš„ PM2 æŒä¹…åŒ–å¹«åŠ©ä»–å€‘ç¶­æŒ 99.99% ä¸Šç·šç‡ã€‚

### 6.2 æ¡ˆä¾‹2: Spotify çš„ç’°å¢ƒè®Šé‡ç®¡ç†ï¼ˆä¾†æºï¼šSpotify Engineering Blog, 2021ï¼‰
Spotify æ¡ç”¨é¡ä¼¼ Doppler çš„å·¥å…·ç®¡ç† API Keyï¼ŒèƒŒæ™¯æ˜¯å¤šåœ˜éšŠå”ä½œçš„å®‰å…¨éœ€æ±‚ã€‚åŸç†åŸºæ–¼é›¶ä¿¡ä»»æ¨¡å‹ï¼Œå¯¦ä¾‹åŒ…æ‹¬æ•´åˆ OpenAI API æ™‚é¿å… Key æ´©éœ²ï¼Œçµæœæ˜¯é›¶å®‰å…¨äº‹ä»¶ã€‚å°æˆ‘å€‘çš„éƒ¨ç½²ï¼Œé€™å¼·èª¿ .gitignore çš„é‡è¦æ€§ã€‚

### 6.3 æ¡ˆä¾‹3: Twitter (ç¾ X) çš„ Web æœå‹™é·ç§»ï¼ˆä¾†æºï¼šCNBC, 2023ï¼‰
Twitter é·ç§»åˆ° GCP å¾Œï¼Œä½¿ç”¨ PM2-like å·¥å…·æŒä¹…åŒ–é€²ç¨‹ï¼ŒèƒŒæ™¯æ˜¯ Elon Musk æ”¶è³¼å¾Œçš„æˆæœ¬å„ªåŒ–ã€‚åŸç†åŒ…æ‹¬è‡ªå‹•é‡å•Ÿä»¥æ‡‰å°æµé‡å³°å€¼ï¼Œå¯¦ä¾‹ä¸­ï¼Œä»–å€‘è™•ç†æ¯æ—¥æ•¸å„„æ¨æ–‡ï¼Œæ¸›å°‘åœæ©Ÿæ™‚é–“ 30%ã€‚é€™é©—è­‰äº†æˆ‘å€‘ Web æœå‹™æ­å»ºçš„å¿…è¦æ€§ã€‚

## ğŸ¯ å­¸ç¿’è·¯ç·šåœ–

### åˆç´šï¼šåŸºç¤å…¥é–€
- äº†è§£ GCP åŸºç¤ï¼šè¨»å†Šå¸³æˆ¶ã€å‰µå»º VM å¯¦ä¾‹ï¼ˆé–±è®€ GCP å®˜æ–¹å…¥é–€æŒ‡å—ï¼‰ã€‚
- å­¸ç¿’ Bash è…³æœ¬å’Œ aliasesï¼šç·´ç¿’ç°¡å–®å‘½ä»¤å¦‚ echo å’Œ aliasã€‚
- å®‰è£ PM2ï¼šé€é npm install pm2 ä¸¦é‹è¡ŒåŸºæœ¬é€²ç¨‹ã€‚

### ä¸­ç´šï¼šå¯¦ä½œéƒ¨ç½²
- é…ç½®ç’°å¢ƒè®Šé‡ï¼šä½¿ç”¨ Doppler æˆ– .env æª”æ¡ˆç®¡ç† Keyã€‚
- æ­å»ºç›£æ§é¢æ¿ï¼šæ•´åˆ GCP Monitoring å’Œè‡ªå»ºè…³æœ¬ã€‚
- éƒ¨ç½² Web æœå‹™ï¼šä½¿ç”¨ Express å‰µå»ºç°¡å–® API ç«¯é»ã€‚

### é«˜ç´šï¼šå„ªåŒ–èˆ‡å®‰å…¨
- å¯¦ç¾ PM2 è‡ªå•Ÿå‹•å’Œ Nginx åå‘ä»£ç†ã€‚
- é€²è¡Œæˆæœ¬å„ªåŒ–å’Œå®‰å…¨å¯©è¨ˆï¼šä½¿ç”¨ gcloud CLI ç›£æ§èŠ±è²»ï¼Œé…ç½®é˜²ç«ç‰†ã€‚
- æ•´åˆ AI APIï¼šå¦‚ Geminiï¼Œå»ºæ§‹ç”Ÿç”¢ç´šæ‡‰ç”¨ã€‚

## âš¡ å¯¦æˆ°è¦é»
1. å§‹çµ‚å„ªå…ˆé…ç½® PM2 è‡ªå•Ÿå‹•ï¼Œä»¥ç¢ºä¿ç³»çµ±é‡å•Ÿå¾Œæœå‹™ä¸ä¸­æ–·ã€‚
2. ä½¿ç”¨ Doppler ç®¡ç†æ‰€æœ‰ API Keyï¼Œé¿å…ç¡¬ç·¨ç¢¼å¸¶ä¾†çš„å®‰å…¨é¢¨éšªã€‚
3. å®šæœŸæª¢æŸ¥ç›£æ§é¢æ¿ï¼Œè¨­å®šè­¦å ±é–¾å€¼ä»¥æ§åˆ¶ GCP æˆæœ¬ã€‚
4. éƒ¨ç½² Web æœå‹™æ™‚ï¼Œå…ˆæ¸¬è©¦æœ¬åœ°ç«¯é»ï¼Œå†é…ç½®åŸŸåæŒ‡å‘ã€‚
5. å‰µå»º aliases.sh ä¾†ç°¡åŒ–æ—¥å¸¸æ“ä½œï¼Œæé«˜é–‹ç™¼æ•ˆç‡ã€‚
6. é…ç½® Nginx åå‘ä»£ç†ï¼Œæå‡ Web æœå‹™çš„å®‰å…¨æ€§å’Œå¯æ“´å±•æ€§ã€‚
7. åŸ·è¡Œ Notion æ•¸æ“šæ¸…æ´—å‰ï¼Œå‚™ä»½è³‡æ–™ä»¥é˜²æ„å¤–ä¸Ÿå¤±ã€‚
8. å¯©æŸ¥æ–‡æª”å¦‚ READMEï¼Œç¢ºä¿åœ˜éšŠæˆå“¡äº†è§£å®‰å…¨æœ€ä½³å¯¦å‹™ã€‚

## ğŸ”— çŸ¥è­˜åœ–è­œ
- [2-knowledge-base/2.1-ai-strategy/gcp-monitoring-best-practices.md](link-to-related-doc)ï¼šGCP ç›£æ§æœ€ä½³å¯¦å‹™ã€‚
- [2-knowledge-base/2.1-ai-strategy/pm2-advanced-usage.md](link-to-related-doc)ï¼šPM2 é€²éšä½¿ç”¨æŒ‡å—ã€‚
- [2-knowledge-base/2.1-ai-strategy/web-deployment-strategies.md](link-to-related-doc)ï¼šWeb éƒ¨ç½²ç­–ç•¥æ–‡æª”ã€‚
- [2-knowledge-base/2.1-ai-strategy/security-in-cloud.md](link-to-related-doc)ï¼šé›²ç«¯å®‰å…¨è€ƒé‡ã€‚

vector_tags: GCP Deployment, PM2 Persistence, API Monitoring, Environment Variables, Web Services, Cloud Security, Cost Control, Nginx Proxy, AI Integration, Bash Aliases, Production Readiness, System Automation